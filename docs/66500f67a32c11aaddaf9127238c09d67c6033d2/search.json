[
  {
    "objectID": "panel/substance-use/index.html",
    "href": "panel/substance-use/index.html",
    "title": "Prevalence/Trends",
    "section": "",
    "text": "import {\n  plots,\n  downloadData,\n  citation,\n  footnotes,\n  accordionButtons,\n  viewof select,\n  viewof zoomInButton,\n  viewof radio,\n  ageQuestion\n} from \"./documentation.qmd\"\n\n\nhtml`&lt;div style=\"display: flex; gap: 3em\"&gt; ${viewof select} ${viewof zoomInButton} &lt;/div&gt;`\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nviewof radio\n\n\n\n\n\n\n\n\n\nhtml`&lt;h3 style=\"color: #000066;\"&gt; ${radio[0].drug.toLocaleUpperCase()}: Trends in &lt;u&gt;${radio[0].time}&lt;/u&gt; Prevalence among ${ageQuestion} &lt;/h3&gt;`\n\n\n\n\n\n\n\nhtml`&lt;div&gt;${plots}&lt;/di&gt;`\n\n\n\n\n\n\n\ncitation\n\n\n\n\n\n\n\nhtml`${footnotes}`\n\n\n\n\n\n\n\ndownloadData\n\n\n\n\n\n\n\naccordionButtons"
  },
  {
    "objectID": "panel/index.html",
    "href": "panel/index.html",
    "title": "MTF Panel Dashboards",
    "section": "",
    "text": "Prevalence/Trends\n\n\nSubstance Use Prevalence and Trends among Adults\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nDemographic Subgroups\n\n\nDemographic Subgroup Differences in Substance Use among Adults\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCollege Students\n\n\nDifferences in College Students and Noncollege Young Adults\n\n\n\n\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "panel/demographic-subgroups/documentation.html",
    "href": "panel/demographic-subgroups/documentation.html",
    "title": "Chapter 5",
    "section": "",
    "text": "sigData = FileAttachment(\"chapter5_sigtests.csv\").csv({ typed: true })\n\nsigsDrug = sigData.filter(\n  ({ drug }) =&gt; drug === select\n)\n\nsignificance = sigsDrug.filter(({ time }) =&gt; time === radio[0].time)\nsignificance\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nsigLegend1 = html`&lt;style&gt;\n    caption {\n      font-size: 9px;\n    }\n\n    table {\n      margin-bottom: 0.5rem;\n    }\n\n    .small td {\n        font-size: 9px;\n        color: #000066;\n    }\n\n&lt;/style&gt;\n&lt;table class=\"small\" style=\"width: 250px; \"&gt;\n  &lt;caption style=\"color: #000066;\"&gt; &lt;b&gt;&lt;u&gt;2023 Trends&lt;/b&gt;&lt;/u&gt; &lt;/caption&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Men&lt;/td&gt;\n    &lt;td&gt;1-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.oneyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.sig_oneyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt; &lt;/td&gt;\n    &lt;td&gt;5-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.fiveyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.sig_fiveyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr style=\"background-color: white;\"&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;10-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.tenyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.sig_tenyr}&lt;/td&gt;\n  &lt;/tr&gt;\n    &lt;tr&gt;\n    &lt;td&gt;Women&lt;/td&gt;\n    &lt;td&gt;1-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.oneyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.sig_oneyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt; &lt;/td&gt;\n    &lt;td&gt;5-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.fiveyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.sig_fiveyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr style=\"background-color: white;\"&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;10-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.tenyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.sig_tenyr}&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt;`\n\n\nsigLegend2 = html`&lt;style&gt;\n    caption {\n      font-size: 9px;\n    }\n\n    table {\n      margin-bottom: 0.5rem;\n    }\n\n   .small td {\n        font-size: 9px;\n        color: #000066;\n    }\n\n&lt;/style&gt;\n&lt;table class=\"small\" style=\"width: 250px; \"&gt;\n  &lt;caption style=\"color: #000066;\"&gt; &lt;b&gt;&lt;u&gt;2023 Trends&lt;/b&gt;&lt;/u&gt; &lt;/caption&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Black&lt;/td&gt;\n    &lt;td&gt;1-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[3]?.oneyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[3]?.sig_oneyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt; &lt;/td&gt;\n    &lt;td&gt;5-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[3]?.fiveyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[3]?.sig_fiveyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr style=\"background-color: white;\"&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;10-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[3]?.tenyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[3]?.sig_tenyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Hispanic&lt;/td&gt;\n    &lt;td&gt;1-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[4]?.oneyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[4]?.sig_oneyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt; &lt;/td&gt;\n    &lt;td&gt;5-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[4]?.fiveyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[4]?.sig_fiveyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;10-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[4]?.tenyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[4]?.sig_tenyr}&lt;/td&gt;\n  &lt;/tr&gt;\n   &lt;tr&gt;\n    &lt;td&gt;White&lt;/td&gt;\n    &lt;td&gt;1-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[2]?.oneyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[2]?.sig_oneyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt; &lt;/td&gt;\n    &lt;td&gt;5-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[2]?.fiveyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[2]?.sig_fiveyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;10-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[2]?.tenyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[2]?.sig_tenyr}&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt;`\n\nlegendPlace = {if (racedata[0]?.drug == \"Any Drug Other Than Cannabis\" && racedata[0]?.time == \"12 Month\" && racedata[0]?.age == \"Ages 19-30\"){\n  return \"top: 50px; left: 100px;\";\n} else if (racedata[0]?.drug == \"Any Drug Other Than Cannabis\" && racedata[0]?.time == \"30 Day\" && racedata[0]?.age == \"Ages 19-30\") {\n  return \"top: 60px; left: 85px;\";\n} else if (racedata[0]?.drug == \"Any Drug Other Than Cannabis\" && racedata[0]?.time == \"30 Day\" && racedata[0]?.age == \"Ages 35-50\") {\n  return \"bottom: 65px; left: 60px;\";\n} else if (racedata[0]?.drug == \"Cigarettes\" && racedata[0]?.time == \"30 Day\") {\n  return \"top: 60px; right: 10px;\";\n} else {\n  return \"bottom: 65px; right: 50px;\";\n}\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ncombosexPlot = html`\n&lt;div style=\"position: relative;\"&gt;\n  ${sexplot}\n  &lt;div style=\"position: absolute; ${legendPlace} border: solid 1px black;\"&gt;\n    ${sigLegend1}\n  &lt;/div&gt;\n&lt;/div&gt;`\n\n\n\n\n\n\n\ncomboracePlot = html`\n&lt;div style=\"position: relative;\"&gt;\n  ${raceplot}\n  &lt;div style=\"position: absolute; ${legendPlace} border: solid 1px black;\"&gt;\n    ${sigLegend2}\n  &lt;/div&gt;\n&lt;/div&gt;`\n\n\n\n\n\n\n\nrawdata = FileAttachment(\"final_graph5_data.csv\").csv({ typed: true })\n\nalphabetical = rawdata.sort((a, b) =&gt; {\n  if (a.drug && b.drug) {\n    return a.drug.localeCompare(b.drug);\n  } else {\n    return 0; // Preserve the order if 'name' is missing\n  }\n});\n\nparser = d3.timeParse(\"%Y\")\n\nformat = d3.format(\".4\")\n\ndata = {\n  const subset = alphabetical.map(\n    ({ year, drug, estimate, age, time, sex, raceEthnicity }) =&gt; ({\n      year: parser(year),\n      year2: format(year),\n      estimate: +estimate,\n      drug: drug,\n      age: age,\n      time: time,\n      sex: sex,\n      raceEthnicity: raceEthnicity\n    })\n  );\n\n  const filtered = subset.filter(thing =&gt; \n  thing.drug?.toLocaleLowerCase() === select?.toLocaleLowerCase()\n);\n\n  return filtered;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ncitation1 = html`&lt;div style=\"max-width: 750px;\"&gt;&lt;p style=\"font-size: small;\"&gt;Suggested citation: Patrick, M. E., Miech, R. A., Johnston, L. D., & O’Malley, P. M. (2024). Monitoring the Future Panel Study annual report: National data on substance use among adults ages 19 to 65, 1976-2023. Monitoring the Future Monograph Series. Ann Arbor: Institute for Social Research, The University of Michigan.&lt;/p&gt;&lt;/div&gt;`\n\n\n\n\n\n\n\ncitation2 = html`&lt;div style=\"max-width: 750px;\"&gt;&lt;p style=\"font-size: small;\"&gt;Suggested citation: Patrick, M. E., Miech, R. A., Johnston, L. D., & O’Malley, P. M. (2024). Monitoring the Future Panel Study annual report: National data on substance use among adults ages 19 to 65, 1976-2023. Monitoring the Future Monograph Series. Ann Arbor: Institute for Social Research, The University of Michigan.&lt;/p&gt;&lt;/div&gt;`\n\n\n\n\n\n\n\n\n\n\nimport {PersistInput} from \"@john-guerra/persist-input@latest\"\n\nviewof select = PersistInput(\"drug\",\nInputs.select(\n  rawdata.map((d) =&gt; d.drug),\n  {\n    value: \"Alcohol\",\n    width: 175,\n    unique: true\n  }\n))\n\nviewof radio = {\n  const values = d3.group(data, (d) =&gt; d.time);\n  return Inputs.radio(values, {\n    key: values.has(\"12 Month\")\n      ? \"12 Month\"\n      : values.keys().next().value\n  });\n}\n\nviewof radio1 = {\n  const values = d3.group(radio, (d) =&gt; d.age);\n  return Inputs.radio(values, {\n    key: values.has(\"Ages 19-30\")\n      ? \"Ages 19-30\"\n      : values.keys().next().value\n  });\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nhtml`&lt;div&gt; ${sexplot} &lt;/div&gt;`\n\n\n\n\n\n\n\nhtml`&lt;div&gt; ${raceplot} &lt;/div&gt;`\n\n\n\n\n\n\n\n\n\nracedata = radio1.filter(thing =&gt; thing.raceEthnicity != null) \n\nradio1\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nsexdata = radio1.filter(thing =&gt; thing.sex != null)\n\n\n\n\n\n\n\n\n\nimport {addTooltips} from \"@mkfreeman/plot-tooltip\"\n\nformatter = d3.timeFormat(\"%Y\")\n\ncolor1 = d3.scaleOrdinal(\n  [\"BLACK\", \"HISPANIC\", \"WHITE\"],\n  [\"#59bbeb\", \"#6ac4a1\", \"#cca438\"]\n)\n\nsymbol1 = d3.scaleOrdinal(\n  [\"WHITE\", \"BLACK\", \"HISPANIC\"],\n  [\"circle\", \"square\", \"triangle\"]\n)\n\nraceplot = addTooltips(\n  Plot.plot({\n    ariaLabel: \"Adult and Young Adult Substance Use Line Charts\",\n    ariaDescription:\n      \"Drug Prevalence Chart showing estimates of use over time (1975 to 2022) in 19-30 and 35-50 year olds filtered by drug name and reporting interval. Currently showing ${radio[0].drug}\",\n    width: 900,\n    height: 700,\n    marginBottom: 50,\n    style: {\n      overflow: \"visible\",\n      fontSize: 12\n    },\n      symbol: {\n      domain: new Set(racedata.map((d) =&gt; d.raceEthnicity)),\n      range: [...new Set(racedata.map((d) =&gt; d.raceEthnicity))].map(symbol1),\n      legend: true,\n      swatchSize: 23\n    },\n      color: {\n      domain: new Set(racedata.map((d) =&gt; d.raceEthnicity)),\n      range: [...new Set(racedata.map((d) =&gt; d.raceEthnicity))].map(color1),\n    },\n    y: {\n      label: \"Percentage (%)\",\n      labelAnchor: \"center\"\n    },\n    x: {\n      type: \"time\",\n      label: \"Years\",\n      anchor: \"bottom\",\n      labelAnchor: \"center\",\n      domain: [new Date(\"1987-01-01\"), new Date(\"2024-01-01\")]\n    },\n    marks: [\n      Plot.ruleY([0]),\n      Plot.dot(racedata, {\n        x: \"year\",\n        y: \"estimate\",\n        r: 4,\n        fill: \"raceEthnicity\",\n        symbol: \"raceEthnicity\",\n        title: (d) =&gt; `${d.raceEthnicity} \\n ${formatter(d.year)}: ${d.estimate}%`\n      }),\n      Plot.line(racedata, {\n        x: \"year\",\n        y: \"estimate\",\n        z: (d) =&gt; // This creates the line breaks\n          [\n            d.raceEthnicity,\n            d.Flag\n          ].join(),\n        stroke: \"raceEthnicity\"})\n        ]\n  }),\n  { fill: \"raceEthnicity\" }\n)\n\ncolor2 = d3.scaleOrdinal(\n  [\"MEN\", \"WOMEN\"],\n  [\"#59bbeb\", \"#6ac4a1\"]\n)\n\nsymbol2 = d3.scaleOrdinal(\n  [\"MEN\", \"WOMEN\"],\n  [\"circle\", \"square\"]\n)\n\n\nsexplot = addTooltips(\n  Plot.plot({\n    ariaLabel: \"Adult and Young Adult Substance Use Line Charts\",\n    ariaDescription:\n      \"Drug Prevalence Chart showing estimates of use over time (1975 to 2022) in 19-30 and 35-50 year olds filtered by drug name and reporting interval. Currently showing ${radio[0].drug}\",\n    width: 900,\n    height: 700,\n    marginBottom: 50,\n    style: {\n      overflow: \"visible\",\n      fontSize: 12\n    },\n      symbol: {\n      domain: new Set(sexdata.map((d) =&gt; d.sex)),\n      range: [...new Set(sexdata.map((d) =&gt; d.sex))].map(symbol2),\n      legend: true,\n      swatchSize: 23\n    },\n      color: {\n      domain: new Set(sexdata.map((d) =&gt; d.sex)),\n      range: [...new Set(sexdata.map((d) =&gt; d.sex))].map(color2),\n    },\n    y: {\n      label: \"Percentage (%)\",\n      labelAnchor: \"center\"\n    },\n    x: {\n      type: \"time\",\n      label: \"Years\",\n      anchor: \"bottom\",\n      labelAnchor: \"center\",\n      domain: [new Date(\"1987-01-01\"), new Date(\"2024-01-01\")]\n    },\n    marks: [\n      Plot.ruleY([0]),\n      Plot.dot(sexdata, {\n        x: \"year\",\n        y: \"estimate\",\n        r: 4,\n        fill: \"sex\",\n        symbol: \"sex\",\n        title: (d) =&gt; `${d.sex} \\n ${formatter(d.year)}: ${d.estimate}%`\n      }),\n      Plot.line(sexdata, {\n        x: \"year\",\n        y: \"estimate\",\n        z: (d) =&gt; // This creates the line breaks\n          [\n            d.sex,\n            d.Flag\n          ].join(),\n        stroke: \"sex\"})\n        ]\n  }),\n  { fill: \"sex\" }\n)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ndownloadButton = (data, filename) =&gt; {\n  \n  let downloadData;\n  downloadData = new Blob([d3.csvFormat(data)], { type: \"text/csv\" });\n  const size = (downloadData.size / 1024).toFixed(0);\n  const button = DOM.download(\n    downloadData,\n    filename,\n    `Download ${filename} Dataset (~${size} KB)`\n  );\n  return button;\n}\n\nname = `${radio[0].drug} - ${radio[0].time}`\n\ndata2 = radio.map(d =&gt; ({...d, year: d.year2}))\n\ndata3 = data2.map(({year2, ...keep}) =&gt; keep)\n\ndownloadData1 = downloadButton(data3, name)\ndownloadData2 = downloadButton(data3, name)"
  },
  {
    "objectID": "panel/demographic-subgroups/documentation.html#significance-tests",
    "href": "panel/demographic-subgroups/documentation.html#significance-tests",
    "title": "Chapter 5",
    "section": "",
    "text": "sigData = FileAttachment(\"chapter5_sigtests.csv\").csv({ typed: true })\n\nsigsDrug = sigData.filter(\n  ({ drug }) =&gt; drug === select\n)\n\nsignificance = sigsDrug.filter(({ time }) =&gt; time === radio[0].time)\nsignificance"
  },
  {
    "objectID": "panel/demographic-subgroups/documentation.html#significance-legend-in-graph",
    "href": "panel/demographic-subgroups/documentation.html#significance-legend-in-graph",
    "title": "Chapter 5",
    "section": "",
    "text": "sigLegend1 = html`&lt;style&gt;\n    caption {\n      font-size: 9px;\n    }\n\n    table {\n      margin-bottom: 0.5rem;\n    }\n\n    .small td {\n        font-size: 9px;\n        color: #000066;\n    }\n\n&lt;/style&gt;\n&lt;table class=\"small\" style=\"width: 250px; \"&gt;\n  &lt;caption style=\"color: #000066;\"&gt; &lt;b&gt;&lt;u&gt;2023 Trends&lt;/b&gt;&lt;/u&gt; &lt;/caption&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Men&lt;/td&gt;\n    &lt;td&gt;1-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.oneyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.sig_oneyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt; &lt;/td&gt;\n    &lt;td&gt;5-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.fiveyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.sig_fiveyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr style=\"background-color: white;\"&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;10-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.tenyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.sig_tenyr}&lt;/td&gt;\n  &lt;/tr&gt;\n    &lt;tr&gt;\n    &lt;td&gt;Women&lt;/td&gt;\n    &lt;td&gt;1-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.oneyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.sig_oneyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt; &lt;/td&gt;\n    &lt;td&gt;5-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.fiveyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.sig_fiveyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr style=\"background-color: white;\"&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;10-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.tenyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.sig_tenyr}&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt;`\n\n\nsigLegend2 = html`&lt;style&gt;\n    caption {\n      font-size: 9px;\n    }\n\n    table {\n      margin-bottom: 0.5rem;\n    }\n\n   .small td {\n        font-size: 9px;\n        color: #000066;\n    }\n\n&lt;/style&gt;\n&lt;table class=\"small\" style=\"width: 250px; \"&gt;\n  &lt;caption style=\"color: #000066;\"&gt; &lt;b&gt;&lt;u&gt;2023 Trends&lt;/b&gt;&lt;/u&gt; &lt;/caption&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Black&lt;/td&gt;\n    &lt;td&gt;1-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[3]?.oneyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[3]?.sig_oneyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt; &lt;/td&gt;\n    &lt;td&gt;5-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[3]?.fiveyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[3]?.sig_fiveyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr style=\"background-color: white;\"&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;10-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[3]?.tenyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[3]?.sig_tenyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Hispanic&lt;/td&gt;\n    &lt;td&gt;1-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[4]?.oneyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[4]?.sig_oneyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt; &lt;/td&gt;\n    &lt;td&gt;5-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[4]?.fiveyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[4]?.sig_fiveyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;10-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[4]?.tenyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[4]?.sig_tenyr}&lt;/td&gt;\n  &lt;/tr&gt;\n   &lt;tr&gt;\n    &lt;td&gt;White&lt;/td&gt;\n    &lt;td&gt;1-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[2]?.oneyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[2]?.sig_oneyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt; &lt;/td&gt;\n    &lt;td&gt;5-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[2]?.fiveyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[2]?.sig_fiveyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;10-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[2]?.tenyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[2]?.sig_tenyr}&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt;`\n\nlegendPlace = {if (racedata[0]?.drug == \"Any Drug Other Than Cannabis\" && racedata[0]?.time == \"12 Month\" && racedata[0]?.age == \"Ages 19-30\"){\n  return \"top: 50px; left: 100px;\";\n} else if (racedata[0]?.drug == \"Any Drug Other Than Cannabis\" && racedata[0]?.time == \"30 Day\" && racedata[0]?.age == \"Ages 19-30\") {\n  return \"top: 60px; left: 85px;\";\n} else if (racedata[0]?.drug == \"Any Drug Other Than Cannabis\" && racedata[0]?.time == \"30 Day\" && racedata[0]?.age == \"Ages 35-50\") {\n  return \"bottom: 65px; left: 60px;\";\n} else if (racedata[0]?.drug == \"Cigarettes\" && racedata[0]?.time == \"30 Day\") {\n  return \"top: 60px; right: 10px;\";\n} else {\n  return \"bottom: 65px; right: 50px;\";\n}\n}"
  },
  {
    "objectID": "panel/demographic-subgroups/documentation.html#combined-sig-plot-with-legend",
    "href": "panel/demographic-subgroups/documentation.html#combined-sig-plot-with-legend",
    "title": "Chapter 5",
    "section": "",
    "text": "combosexPlot = html`\n&lt;div style=\"position: relative;\"&gt;\n  ${sexplot}\n  &lt;div style=\"position: absolute; ${legendPlace} border: solid 1px black;\"&gt;\n    ${sigLegend1}\n  &lt;/div&gt;\n&lt;/div&gt;`\n\n\n\n\n\n\n\ncomboracePlot = html`\n&lt;div style=\"position: relative;\"&gt;\n  ${raceplot}\n  &lt;div style=\"position: absolute; ${legendPlace} border: solid 1px black;\"&gt;\n    ${sigLegend2}\n  &lt;/div&gt;\n&lt;/div&gt;`\n\n\n\n\n\n\n\nrawdata = FileAttachment(\"final_graph5_data.csv\").csv({ typed: true })\n\nalphabetical = rawdata.sort((a, b) =&gt; {\n  if (a.drug && b.drug) {\n    return a.drug.localeCompare(b.drug);\n  } else {\n    return 0; // Preserve the order if 'name' is missing\n  }\n});\n\nparser = d3.timeParse(\"%Y\")\n\nformat = d3.format(\".4\")\n\ndata = {\n  const subset = alphabetical.map(\n    ({ year, drug, estimate, age, time, sex, raceEthnicity }) =&gt; ({\n      year: parser(year),\n      year2: format(year),\n      estimate: +estimate,\n      drug: drug,\n      age: age,\n      time: time,\n      sex: sex,\n      raceEthnicity: raceEthnicity\n    })\n  );\n\n  const filtered = subset.filter(thing =&gt; \n  thing.drug?.toLocaleLowerCase() === select?.toLocaleLowerCase()\n);\n\n  return filtered;\n}"
  },
  {
    "objectID": "panel/demographic-subgroups/documentation.html#citations",
    "href": "panel/demographic-subgroups/documentation.html#citations",
    "title": "Chapter 5",
    "section": "",
    "text": "citation1 = html`&lt;div style=\"max-width: 750px;\"&gt;&lt;p style=\"font-size: small;\"&gt;Suggested citation: Patrick, M. E., Miech, R. A., Johnston, L. D., & O’Malley, P. M. (2024). Monitoring the Future Panel Study annual report: National data on substance use among adults ages 19 to 65, 1976-2023. Monitoring the Future Monograph Series. Ann Arbor: Institute for Social Research, The University of Michigan.&lt;/p&gt;&lt;/div&gt;`\n\n\n\n\n\n\n\ncitation2 = html`&lt;div style=\"max-width: 750px;\"&gt;&lt;p style=\"font-size: small;\"&gt;Suggested citation: Patrick, M. E., Miech, R. A., Johnston, L. D., & O’Malley, P. M. (2024). Monitoring the Future Panel Study annual report: National data on substance use among adults ages 19 to 65, 1976-2023. Monitoring the Future Monograph Series. Ann Arbor: Institute for Social Research, The University of Michigan.&lt;/p&gt;&lt;/div&gt;`"
  },
  {
    "objectID": "panel/demographic-subgroups/documentation.html#download-data-button",
    "href": "panel/demographic-subgroups/documentation.html#download-data-button",
    "title": "Chapter 5",
    "section": "",
    "text": "import {PersistInput} from \"@john-guerra/persist-input@latest\"\n\nviewof select = PersistInput(\"drug\",\nInputs.select(\n  rawdata.map((d) =&gt; d.drug),\n  {\n    value: \"Alcohol\",\n    width: 175,\n    unique: true\n  }\n))\n\nviewof radio = {\n  const values = d3.group(data, (d) =&gt; d.time);\n  return Inputs.radio(values, {\n    key: values.has(\"12 Month\")\n      ? \"12 Month\"\n      : values.keys().next().value\n  });\n}\n\nviewof radio1 = {\n  const values = d3.group(radio, (d) =&gt; d.age);\n  return Inputs.radio(values, {\n    key: values.has(\"Ages 19-30\")\n      ? \"Ages 19-30\"\n      : values.keys().next().value\n  });\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nhtml`&lt;div&gt; ${sexplot} &lt;/div&gt;`\n\n\n\n\n\n\n\nhtml`&lt;div&gt; ${raceplot} &lt;/div&gt;`\n\n\n\n\n\n\n\n\n\nracedata = radio1.filter(thing =&gt; thing.raceEthnicity != null) \n\nradio1\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nsexdata = radio1.filter(thing =&gt; thing.sex != null)\n\n\n\n\n\n\n\n\n\nimport {addTooltips} from \"@mkfreeman/plot-tooltip\"\n\nformatter = d3.timeFormat(\"%Y\")\n\ncolor1 = d3.scaleOrdinal(\n  [\"BLACK\", \"HISPANIC\", \"WHITE\"],\n  [\"#59bbeb\", \"#6ac4a1\", \"#cca438\"]\n)\n\nsymbol1 = d3.scaleOrdinal(\n  [\"WHITE\", \"BLACK\", \"HISPANIC\"],\n  [\"circle\", \"square\", \"triangle\"]\n)\n\nraceplot = addTooltips(\n  Plot.plot({\n    ariaLabel: \"Adult and Young Adult Substance Use Line Charts\",\n    ariaDescription:\n      \"Drug Prevalence Chart showing estimates of use over time (1975 to 2022) in 19-30 and 35-50 year olds filtered by drug name and reporting interval. Currently showing ${radio[0].drug}\",\n    width: 900,\n    height: 700,\n    marginBottom: 50,\n    style: {\n      overflow: \"visible\",\n      fontSize: 12\n    },\n      symbol: {\n      domain: new Set(racedata.map((d) =&gt; d.raceEthnicity)),\n      range: [...new Set(racedata.map((d) =&gt; d.raceEthnicity))].map(symbol1),\n      legend: true,\n      swatchSize: 23\n    },\n      color: {\n      domain: new Set(racedata.map((d) =&gt; d.raceEthnicity)),\n      range: [...new Set(racedata.map((d) =&gt; d.raceEthnicity))].map(color1),\n    },\n    y: {\n      label: \"Percentage (%)\",\n      labelAnchor: \"center\"\n    },\n    x: {\n      type: \"time\",\n      label: \"Years\",\n      anchor: \"bottom\",\n      labelAnchor: \"center\",\n      domain: [new Date(\"1987-01-01\"), new Date(\"2024-01-01\")]\n    },\n    marks: [\n      Plot.ruleY([0]),\n      Plot.dot(racedata, {\n        x: \"year\",\n        y: \"estimate\",\n        r: 4,\n        fill: \"raceEthnicity\",\n        symbol: \"raceEthnicity\",\n        title: (d) =&gt; `${d.raceEthnicity} \\n ${formatter(d.year)}: ${d.estimate}%`\n      }),\n      Plot.line(racedata, {\n        x: \"year\",\n        y: \"estimate\",\n        z: (d) =&gt; // This creates the line breaks\n          [\n            d.raceEthnicity,\n            d.Flag\n          ].join(),\n        stroke: \"raceEthnicity\"})\n        ]\n  }),\n  { fill: \"raceEthnicity\" }\n)\n\ncolor2 = d3.scaleOrdinal(\n  [\"MEN\", \"WOMEN\"],\n  [\"#59bbeb\", \"#6ac4a1\"]\n)\n\nsymbol2 = d3.scaleOrdinal(\n  [\"MEN\", \"WOMEN\"],\n  [\"circle\", \"square\"]\n)\n\n\nsexplot = addTooltips(\n  Plot.plot({\n    ariaLabel: \"Adult and Young Adult Substance Use Line Charts\",\n    ariaDescription:\n      \"Drug Prevalence Chart showing estimates of use over time (1975 to 2022) in 19-30 and 35-50 year olds filtered by drug name and reporting interval. Currently showing ${radio[0].drug}\",\n    width: 900,\n    height: 700,\n    marginBottom: 50,\n    style: {\n      overflow: \"visible\",\n      fontSize: 12\n    },\n      symbol: {\n      domain: new Set(sexdata.map((d) =&gt; d.sex)),\n      range: [...new Set(sexdata.map((d) =&gt; d.sex))].map(symbol2),\n      legend: true,\n      swatchSize: 23\n    },\n      color: {\n      domain: new Set(sexdata.map((d) =&gt; d.sex)),\n      range: [...new Set(sexdata.map((d) =&gt; d.sex))].map(color2),\n    },\n    y: {\n      label: \"Percentage (%)\",\n      labelAnchor: \"center\"\n    },\n    x: {\n      type: \"time\",\n      label: \"Years\",\n      anchor: \"bottom\",\n      labelAnchor: \"center\",\n      domain: [new Date(\"1987-01-01\"), new Date(\"2024-01-01\")]\n    },\n    marks: [\n      Plot.ruleY([0]),\n      Plot.dot(sexdata, {\n        x: \"year\",\n        y: \"estimate\",\n        r: 4,\n        fill: \"sex\",\n        symbol: \"sex\",\n        title: (d) =&gt; `${d.sex} \\n ${formatter(d.year)}: ${d.estimate}%`\n      }),\n      Plot.line(sexdata, {\n        x: \"year\",\n        y: \"estimate\",\n        z: (d) =&gt; // This creates the line breaks\n          [\n            d.sex,\n            d.Flag\n          ].join(),\n        stroke: \"sex\"})\n        ]\n  }),\n  { fill: \"sex\" }\n)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ndownloadButton = (data, filename) =&gt; {\n  \n  let downloadData;\n  downloadData = new Blob([d3.csvFormat(data)], { type: \"text/csv\" });\n  const size = (downloadData.size / 1024).toFixed(0);\n  const button = DOM.download(\n    downloadData,\n    filename,\n    `Download ${filename} Dataset (~${size} KB)`\n  );\n  return button;\n}\n\nname = `${radio[0].drug} - ${radio[0].time}`\n\ndata2 = radio.map(d =&gt; ({...d, year: d.year2}))\n\ndata3 = data2.map(({year2, ...keep}) =&gt; keep)\n\ndownloadData1 = downloadButton(data3, name)\ndownloadData2 = downloadButton(data3, name)"
  },
  {
    "objectID": "panel/college-noncollege/documentation.html",
    "href": "panel/college-noncollege/documentation.html",
    "title": "Chapter 4",
    "section": "",
    "text": "sigData = FileAttachment(\"chapter4_sigtests.csv\").csv({ typed: true })\n\nsigsDrug = sigData.filter(\n  ({ drug }) =&gt; drug === select\n)\n\nsignificance = sigsDrug.filter(({ time }) =&gt; time === radio[0].time)\nsignificance\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nsigLegend1 = html`&lt;style&gt;\n    caption {\n      font-size: 9px;\n    }\n\n    table {\n      margin-bottom: 0.5rem;\n    }\n\n    .small td {\n        font-size: 9px;\n        color: #000066;\n    }\n\n&lt;/style&gt;\n&lt;table class=\"small\" style=\"width: 250px; \"&gt;\n  &lt;caption style=\"color: #000066;\"&gt; &lt;b&gt;&lt;u&gt;2023 Trends&lt;/b&gt;&lt;/u&gt; &lt;/caption&gt;\n  &lt;tr&gt;\n    &lt;td&gt;College Students&lt;/td&gt;\n    &lt;td&gt;1-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.oneyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.sig_oneyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt; &lt;/td&gt;\n    &lt;td&gt;5-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.fiveyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.sig_fiveyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr style=\"background-color: white;\"&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;10-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.tenyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.sig_tenyr}&lt;/td&gt;\n  &lt;/tr&gt;\n    &lt;tr&gt;\n    &lt;td&gt;Noncollege Young Adults&lt;/td&gt;\n    &lt;td&gt;1-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.oneyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.sig_oneyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt; &lt;/td&gt;\n    &lt;td&gt;5-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.fiveyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.sig_fiveyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr style=\"background-color: white;\"&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;10-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.tenyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.sig_tenyr}&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt;`\n\n\nsigLegend2 = html`&lt;style&gt;\n    caption {\n      font-size: 9px;\n    }\n\n    table {\n      margin-bottom: 0.5rem;\n    }\n\n   .small td {\n        font-size: 9px;\n        color: #000066;\n    }\n\n&lt;/style&gt;\n&lt;table class=\"small\" style=\"width: 250px; \"&gt;\n  &lt;caption style=\"color: #000066;\"&gt; &lt;b&gt;&lt;u&gt;2023 Trends&lt;/b&gt;&lt;/u&gt; &lt;/caption&gt;\n  &lt;tr&gt;\n    &lt;td&gt;College Men&lt;/td&gt;\n    &lt;td&gt;1-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[2]?.oneyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[2]?.sig_oneyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt; &lt;/td&gt;\n    &lt;td&gt;5-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[2]?.fiveyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[2]?.sig_fiveyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr style=\"background-color: white;\"&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;10-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[2]?.tenyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[2]?.sig_tenyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;College Women&lt;/td&gt;\n    &lt;td&gt;1-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[3]?.oneyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[3]?.sig_oneyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;5-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[3]?.fiveyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[3]?.sig_fiveyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;10-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[3]?.tenyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[3]?.sig_tenyr}&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt;`\n\nlegendPlace = {if (collegedata[0]?.drug == \"Cigarettes\" && collegedata[0]?.time == \"30 Day\"){\n  return \"top: 60px; right: 10px;\";\n} else if (collegedata[0]?.drug == \"Any Drug Other Than Cannabis\" && collegedata[0]?.time == \"30 Day\"){\n  return \"bottom: 65px; right: 70px;\";\n} else {\n  return \"bottom: 65px; right: 50px;\";\n}\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ncombosexPlot = html`\n&lt;div style=\"position: relative;\"&gt;\n  ${sexplot}\n  &lt;div style=\"position: absolute; ${legendPlace} border: solid 1px black;\"&gt;\n    ${sigLegend2}\n  &lt;/div&gt;\n&lt;/div&gt;`\n\n\n\n\n\n\n\ncombocollegePlot = html`\n&lt;div style=\"position: relative;\"&gt;\n  ${collegeplot}\n  &lt;div style=\"position: absolute; ${legendPlace} border: solid 1px black;\"&gt;\n    ${sigLegend1}\n  &lt;/div&gt;\n&lt;/div&gt;`\n\n\n\n\n\n\n\nrawdata = FileAttachment(\"final_graph4_data.csv\").csv({ typed: true })\n\nalphabetical = rawdata.sort((a, b) =&gt; {\n  if (a.drug && b.drug) {\n    return a.drug.localeCompare(b.drug);\n  } else {\n    return 0; // Preserve the order if 'name' is missing\n  }\n});\n\nparser = d3.timeParse(\"%Y\")\n\nformat = d3.format(\".4\")\n\ndata = {\n  const subset = alphabetical.map(\n    ({ year, drug, estimate, time, sex, college }) =&gt; ({\n      year: parser(year),\n      year2: format(year),\n      estimate: +estimate,\n      drug: drug,\n      time: time,\n      sex: sex,\n      college: college\n    })\n  );\n\n  const filtered = subset.filter(thing =&gt; \n  thing.drug?.toLocaleLowerCase() === select?.toLocaleLowerCase()\n);\n\n  return filtered;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ncitation1 = html`&lt;div style=\"max-width: 750px;\"&gt;&lt;p style=\"font-size: small;\"&gt;Suggested citation: Patrick, M. E., Miech, R. A., Johnston, L. D., & O’Malley, P. M. (2024). Monitoring the Future Panel Study annual report: National data on substance use among adults ages 19 to 65, 1976-2023. Monitoring the Future Monograph Series. Ann Arbor: Institute for Social Research, The University of Michigan.&lt;/p&gt;&lt;/div&gt;`\n\n\n\n\n\n\n\ncitation2 = html`&lt;div style=\"max-width: 750px;\"&gt;&lt;p style=\"font-size: small;\"&gt;Suggested citation: Patrick, M. E., Miech, R. A., Johnston, L. D., & O’Malley, P. M. (2024). Monitoring the Future Panel Study annual report: National data on substance use among adults ages 19 to 65, 1976-2023. Monitoring the Future Monograph Series. Ann Arbor: Institute for Social Research, The University of Michigan.&lt;/p&gt;&lt;/div&gt;`\n\n\n\n\n\n\n\n\n\n\nimport {PersistInput} from \"@john-guerra/persist-input@latest\"\n\nviewof select = PersistInput(\"drug\",\nInputs.select(\n  rawdata.map((d) =&gt; d.drug),\n  {\n    value: \"Alcohol\",\n    width: 175,\n    unique: true\n  }\n))\n\nviewof radio = {\n  const values = d3.group(data, (d) =&gt; d.time);\n  return Inputs.radio(values, {\n    key: values.has(\"12 Month\")\n      ? \"12 Month\"\n      : values.keys().next().value\n  });\n}\n\n sexdata = radio.filter(d =&gt; d.sex != \".\")\n\n collegedata = radio.filter(d =&gt; d.college != \".\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nhtml`&lt;div&gt; ${sexplot} &lt;/div&gt;`\n\n\n\n\n\n\n\nhtml`&lt;div&gt; ${collegeplot} &lt;/div&gt;`\n\n\n\n\n\n\n\n\n\nimport {addTooltips} from \"@mkfreeman/plot-tooltip\"\n\nformatter = d3.timeFormat(\"%Y\")\n\ncolor1 = d3.scaleOrdinal(\n  [\"College Students\", \"Noncollege Young Adults\", \"WHITE\"],\n  [\"#59bbeb\", \"#6ac4a1\", \"#cca438\"]\n)\n\nsymbol1 = d3.scaleOrdinal(\n  [\"College Students\", \"Noncollege Young Adults\"],\n  [\"circle\", \"square\"]\n)\n\ncollegeplot = addTooltips(\n  Plot.plot({\n    ariaLabel: \"Adult and Young Adult Substance Use Line Charts\",\n    ariaDescription:\n      \"Drug Prevalence Chart showing estimates of use over time (1975 to 2022) in 19-30 and 35-50 year olds filtered by drug name and reporting interval. Currently showing ${radio[0].drug}\",\n    width: 900,\n    height: 700,\n    marginBottom: 50,\n    style: {\n      overflow: \"visible\",\n      fontSize: 12\n    },\n      symbol: {\n      domain: new Set(collegedata.map((d) =&gt; d.college)),\n      range: [...new Set(collegedata.map((d) =&gt; d.college))].map(symbol1),\n      legend: true,\n      swatchSize: 23\n    },\n      color: {\n      domain: new Set(collegedata.map((d) =&gt; d.college)),\n      range: [...new Set(collegedata.map((d) =&gt; d.college))].map(color1),\n    },\n    y: {\n      label: \"Percentage (%)\",\n      labelAnchor: \"center\"\n    },\n    x: {\n      type: \"time\",\n      label: \"Years\",\n      anchor: \"bottom\",\n      labelAnchor: \"center\",\n      domain: [new Date(\"1987-01-01\"), new Date(\"2024-01-01\")]\n    },\n    marks: [\n      Plot.ruleY([0]),\n      Plot.dot(radio, {\n        x: \"year\",\n        y: \"estimate\",\n        r: 4,\n        fill: \"college\",\n        symbol: \"college\",\n        title: (d) =&gt; `${d.college} \\n ${formatter(d.year)}: ${d.estimate}%`\n      }),\n      Plot.line(radio, {\n        x: \"year\",\n        y: \"estimate\",\n        z: (d) =&gt; // This creates the line breaks\n          [\n            d.college,\n            d.Flag\n          ].join(),\n        stroke: \"college\"})\n        ]\n  }),\n  { fill: \"college\" }\n)\n\ncolor2 = d3.scaleOrdinal(\n  [\"MEN\", \"WOMEN\"],\n  [\"#59bbeb\", \"#6ac4a1\"]\n)\n\nsymbol2 = d3.scaleOrdinal(\n  [\"MEN\", \"WOMEN\"],\n  [\"circle\", \"square\"]\n)\n\n\nsexplot = addTooltips(\n  Plot.plot({\n    ariaLabel: \"Adult and Young Adult Substance Use Line Charts\",\n    ariaDescription:\n      \"Drug Prevalence Chart showing estimates of use over time (1975 to 2022) in 19-30 and 35-50 year olds filtered by drug name and reporting interval. Currently showing ${radio[0].drug}\",\n    width: 900,\n    height: 700,\n    marginBottom: 50,\n    style: {\n      overflow: \"visible\",\n      fontSize: 12\n    },\n      symbol: {\n      domain: new Set(sexdata.map((d) =&gt; d.sex)),\n      range: [...new Set(sexdata.map((d) =&gt; d.sex))].map(symbol2),\n      legend: true,\n      swatchSize: 23\n    },\n      color: {\n      domain: new Set(sexdata.map((d) =&gt; d.sex)),\n      range: [...new Set(sexdata.map((d) =&gt; d.sex))].map(color2),\n    },\n    y: {\n      label: \"Percentage (%)\",\n      labelAnchor: \"center\"\n    },\n    x: {\n      type: \"time\",\n      label: \"Years\",\n      anchor: \"bottom\",\n      labelAnchor: \"center\",\n      domain: [new Date(\"1987-01-01\"), new Date(\"2024-01-01\")]\n    },\n    marks: [\n      Plot.ruleY([0]),\n      Plot.dot(sexdata, {\n        x: \"year\",\n        y: \"estimate\",\n        r: 4,\n        fill: \"sex\",\n        symbol: \"sex\",\n        title: (d) =&gt; `${d.sex} \\n ${formatter(d.year)}: ${d.estimate}%`\n      }),\n      Plot.line(sexdata, {\n        x: \"year\",\n        y: \"estimate\",\n        z: (d) =&gt; // This creates the line breaks\n          [\n            d.sex,\n            d.Flag\n          ].join(),\n        stroke: \"sex\"})\n        ]\n  }),\n  { fill: \"sex\" }\n)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ndownloadButton = (data, filename) =&gt; {\n  \n  let downloadData;\n  downloadData = new Blob([d3.csvFormat(data)], { type: \"text/csv\" });\n  const size = (downloadData.size / 1024).toFixed(0);\n  const button = DOM.download(\n    downloadData,\n    filename,\n    `Download ${filename} Dataset (~${size} KB)`\n  );\n  return button;\n}\n\nname = `${radio[0].drug} - ${radio[0].time}`\n\ndata2 = radio.map(d =&gt; ({...d, year: d.year2}))\n\ndata3 = data2.map(({year2, ...keep}) =&gt; keep)\n\ndownloadData1 = downloadButton(data3, name)\ndownloadData2 = downloadButton(data3, name)"
  },
  {
    "objectID": "panel/college-noncollege/documentation.html#significance-tests",
    "href": "panel/college-noncollege/documentation.html#significance-tests",
    "title": "Chapter 4",
    "section": "",
    "text": "sigData = FileAttachment(\"chapter4_sigtests.csv\").csv({ typed: true })\n\nsigsDrug = sigData.filter(\n  ({ drug }) =&gt; drug === select\n)\n\nsignificance = sigsDrug.filter(({ time }) =&gt; time === radio[0].time)\nsignificance"
  },
  {
    "objectID": "panel/college-noncollege/documentation.html#significance-legend-in-graph",
    "href": "panel/college-noncollege/documentation.html#significance-legend-in-graph",
    "title": "Chapter 4",
    "section": "",
    "text": "sigLegend1 = html`&lt;style&gt;\n    caption {\n      font-size: 9px;\n    }\n\n    table {\n      margin-bottom: 0.5rem;\n    }\n\n    .small td {\n        font-size: 9px;\n        color: #000066;\n    }\n\n&lt;/style&gt;\n&lt;table class=\"small\" style=\"width: 250px; \"&gt;\n  &lt;caption style=\"color: #000066;\"&gt; &lt;b&gt;&lt;u&gt;2023 Trends&lt;/b&gt;&lt;/u&gt; &lt;/caption&gt;\n  &lt;tr&gt;\n    &lt;td&gt;College Students&lt;/td&gt;\n    &lt;td&gt;1-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.oneyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.sig_oneyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt; &lt;/td&gt;\n    &lt;td&gt;5-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.fiveyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.sig_fiveyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr style=\"background-color: white;\"&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;10-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.tenyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.sig_tenyr}&lt;/td&gt;\n  &lt;/tr&gt;\n    &lt;tr&gt;\n    &lt;td&gt;Noncollege Young Adults&lt;/td&gt;\n    &lt;td&gt;1-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.oneyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.sig_oneyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt; &lt;/td&gt;\n    &lt;td&gt;5-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.fiveyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.sig_fiveyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr style=\"background-color: white;\"&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;10-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.tenyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.sig_tenyr}&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt;`\n\n\nsigLegend2 = html`&lt;style&gt;\n    caption {\n      font-size: 9px;\n    }\n\n    table {\n      margin-bottom: 0.5rem;\n    }\n\n   .small td {\n        font-size: 9px;\n        color: #000066;\n    }\n\n&lt;/style&gt;\n&lt;table class=\"small\" style=\"width: 250px; \"&gt;\n  &lt;caption style=\"color: #000066;\"&gt; &lt;b&gt;&lt;u&gt;2023 Trends&lt;/b&gt;&lt;/u&gt; &lt;/caption&gt;\n  &lt;tr&gt;\n    &lt;td&gt;College Men&lt;/td&gt;\n    &lt;td&gt;1-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[2]?.oneyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[2]?.sig_oneyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt; &lt;/td&gt;\n    &lt;td&gt;5-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[2]?.fiveyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[2]?.sig_fiveyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr style=\"background-color: white;\"&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;10-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[2]?.tenyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[2]?.sig_tenyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;College Women&lt;/td&gt;\n    &lt;td&gt;1-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[3]?.oneyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[3]?.sig_oneyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;5-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[3]?.fiveyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[3]?.sig_fiveyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;10-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[3]?.tenyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[3]?.sig_tenyr}&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt;`\n\nlegendPlace = {if (collegedata[0]?.drug == \"Cigarettes\" && collegedata[0]?.time == \"30 Day\"){\n  return \"top: 60px; right: 10px;\";\n} else if (collegedata[0]?.drug == \"Any Drug Other Than Cannabis\" && collegedata[0]?.time == \"30 Day\"){\n  return \"bottom: 65px; right: 70px;\";\n} else {\n  return \"bottom: 65px; right: 50px;\";\n}\n}"
  },
  {
    "objectID": "panel/college-noncollege/documentation.html#combined-sig-plot-with-legend",
    "href": "panel/college-noncollege/documentation.html#combined-sig-plot-with-legend",
    "title": "Chapter 4",
    "section": "",
    "text": "combosexPlot = html`\n&lt;div style=\"position: relative;\"&gt;\n  ${sexplot}\n  &lt;div style=\"position: absolute; ${legendPlace} border: solid 1px black;\"&gt;\n    ${sigLegend2}\n  &lt;/div&gt;\n&lt;/div&gt;`\n\n\n\n\n\n\n\ncombocollegePlot = html`\n&lt;div style=\"position: relative;\"&gt;\n  ${collegeplot}\n  &lt;div style=\"position: absolute; ${legendPlace} border: solid 1px black;\"&gt;\n    ${sigLegend1}\n  &lt;/div&gt;\n&lt;/div&gt;`\n\n\n\n\n\n\n\nrawdata = FileAttachment(\"final_graph4_data.csv\").csv({ typed: true })\n\nalphabetical = rawdata.sort((a, b) =&gt; {\n  if (a.drug && b.drug) {\n    return a.drug.localeCompare(b.drug);\n  } else {\n    return 0; // Preserve the order if 'name' is missing\n  }\n});\n\nparser = d3.timeParse(\"%Y\")\n\nformat = d3.format(\".4\")\n\ndata = {\n  const subset = alphabetical.map(\n    ({ year, drug, estimate, time, sex, college }) =&gt; ({\n      year: parser(year),\n      year2: format(year),\n      estimate: +estimate,\n      drug: drug,\n      time: time,\n      sex: sex,\n      college: college\n    })\n  );\n\n  const filtered = subset.filter(thing =&gt; \n  thing.drug?.toLocaleLowerCase() === select?.toLocaleLowerCase()\n);\n\n  return filtered;\n}"
  },
  {
    "objectID": "panel/college-noncollege/documentation.html#citations",
    "href": "panel/college-noncollege/documentation.html#citations",
    "title": "Chapter 4",
    "section": "",
    "text": "citation1 = html`&lt;div style=\"max-width: 750px;\"&gt;&lt;p style=\"font-size: small;\"&gt;Suggested citation: Patrick, M. E., Miech, R. A., Johnston, L. D., & O’Malley, P. M. (2024). Monitoring the Future Panel Study annual report: National data on substance use among adults ages 19 to 65, 1976-2023. Monitoring the Future Monograph Series. Ann Arbor: Institute for Social Research, The University of Michigan.&lt;/p&gt;&lt;/div&gt;`\n\n\n\n\n\n\n\ncitation2 = html`&lt;div style=\"max-width: 750px;\"&gt;&lt;p style=\"font-size: small;\"&gt;Suggested citation: Patrick, M. E., Miech, R. A., Johnston, L. D., & O’Malley, P. M. (2024). Monitoring the Future Panel Study annual report: National data on substance use among adults ages 19 to 65, 1976-2023. Monitoring the Future Monograph Series. Ann Arbor: Institute for Social Research, The University of Michigan.&lt;/p&gt;&lt;/div&gt;`"
  },
  {
    "objectID": "panel/college-noncollege/documentation.html#download-data-button",
    "href": "panel/college-noncollege/documentation.html#download-data-button",
    "title": "Chapter 4",
    "section": "",
    "text": "import {PersistInput} from \"@john-guerra/persist-input@latest\"\n\nviewof select = PersistInput(\"drug\",\nInputs.select(\n  rawdata.map((d) =&gt; d.drug),\n  {\n    value: \"Alcohol\",\n    width: 175,\n    unique: true\n  }\n))\n\nviewof radio = {\n  const values = d3.group(data, (d) =&gt; d.time);\n  return Inputs.radio(values, {\n    key: values.has(\"12 Month\")\n      ? \"12 Month\"\n      : values.keys().next().value\n  });\n}\n\n sexdata = radio.filter(d =&gt; d.sex != \".\")\n\n collegedata = radio.filter(d =&gt; d.college != \".\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nhtml`&lt;div&gt; ${sexplot} &lt;/div&gt;`\n\n\n\n\n\n\n\nhtml`&lt;div&gt; ${collegeplot} &lt;/div&gt;`\n\n\n\n\n\n\n\n\n\nimport {addTooltips} from \"@mkfreeman/plot-tooltip\"\n\nformatter = d3.timeFormat(\"%Y\")\n\ncolor1 = d3.scaleOrdinal(\n  [\"College Students\", \"Noncollege Young Adults\", \"WHITE\"],\n  [\"#59bbeb\", \"#6ac4a1\", \"#cca438\"]\n)\n\nsymbol1 = d3.scaleOrdinal(\n  [\"College Students\", \"Noncollege Young Adults\"],\n  [\"circle\", \"square\"]\n)\n\ncollegeplot = addTooltips(\n  Plot.plot({\n    ariaLabel: \"Adult and Young Adult Substance Use Line Charts\",\n    ariaDescription:\n      \"Drug Prevalence Chart showing estimates of use over time (1975 to 2022) in 19-30 and 35-50 year olds filtered by drug name and reporting interval. Currently showing ${radio[0].drug}\",\n    width: 900,\n    height: 700,\n    marginBottom: 50,\n    style: {\n      overflow: \"visible\",\n      fontSize: 12\n    },\n      symbol: {\n      domain: new Set(collegedata.map((d) =&gt; d.college)),\n      range: [...new Set(collegedata.map((d) =&gt; d.college))].map(symbol1),\n      legend: true,\n      swatchSize: 23\n    },\n      color: {\n      domain: new Set(collegedata.map((d) =&gt; d.college)),\n      range: [...new Set(collegedata.map((d) =&gt; d.college))].map(color1),\n    },\n    y: {\n      label: \"Percentage (%)\",\n      labelAnchor: \"center\"\n    },\n    x: {\n      type: \"time\",\n      label: \"Years\",\n      anchor: \"bottom\",\n      labelAnchor: \"center\",\n      domain: [new Date(\"1987-01-01\"), new Date(\"2024-01-01\")]\n    },\n    marks: [\n      Plot.ruleY([0]),\n      Plot.dot(radio, {\n        x: \"year\",\n        y: \"estimate\",\n        r: 4,\n        fill: \"college\",\n        symbol: \"college\",\n        title: (d) =&gt; `${d.college} \\n ${formatter(d.year)}: ${d.estimate}%`\n      }),\n      Plot.line(radio, {\n        x: \"year\",\n        y: \"estimate\",\n        z: (d) =&gt; // This creates the line breaks\n          [\n            d.college,\n            d.Flag\n          ].join(),\n        stroke: \"college\"})\n        ]\n  }),\n  { fill: \"college\" }\n)\n\ncolor2 = d3.scaleOrdinal(\n  [\"MEN\", \"WOMEN\"],\n  [\"#59bbeb\", \"#6ac4a1\"]\n)\n\nsymbol2 = d3.scaleOrdinal(\n  [\"MEN\", \"WOMEN\"],\n  [\"circle\", \"square\"]\n)\n\n\nsexplot = addTooltips(\n  Plot.plot({\n    ariaLabel: \"Adult and Young Adult Substance Use Line Charts\",\n    ariaDescription:\n      \"Drug Prevalence Chart showing estimates of use over time (1975 to 2022) in 19-30 and 35-50 year olds filtered by drug name and reporting interval. Currently showing ${radio[0].drug}\",\n    width: 900,\n    height: 700,\n    marginBottom: 50,\n    style: {\n      overflow: \"visible\",\n      fontSize: 12\n    },\n      symbol: {\n      domain: new Set(sexdata.map((d) =&gt; d.sex)),\n      range: [...new Set(sexdata.map((d) =&gt; d.sex))].map(symbol2),\n      legend: true,\n      swatchSize: 23\n    },\n      color: {\n      domain: new Set(sexdata.map((d) =&gt; d.sex)),\n      range: [...new Set(sexdata.map((d) =&gt; d.sex))].map(color2),\n    },\n    y: {\n      label: \"Percentage (%)\",\n      labelAnchor: \"center\"\n    },\n    x: {\n      type: \"time\",\n      label: \"Years\",\n      anchor: \"bottom\",\n      labelAnchor: \"center\",\n      domain: [new Date(\"1987-01-01\"), new Date(\"2024-01-01\")]\n    },\n    marks: [\n      Plot.ruleY([0]),\n      Plot.dot(sexdata, {\n        x: \"year\",\n        y: \"estimate\",\n        r: 4,\n        fill: \"sex\",\n        symbol: \"sex\",\n        title: (d) =&gt; `${d.sex} \\n ${formatter(d.year)}: ${d.estimate}%`\n      }),\n      Plot.line(sexdata, {\n        x: \"year\",\n        y: \"estimate\",\n        z: (d) =&gt; // This creates the line breaks\n          [\n            d.sex,\n            d.Flag\n          ].join(),\n        stroke: \"sex\"})\n        ]\n  }),\n  { fill: \"sex\" }\n)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ndownloadButton = (data, filename) =&gt; {\n  \n  let downloadData;\n  downloadData = new Blob([d3.csvFormat(data)], { type: \"text/csv\" });\n  const size = (downloadData.size / 1024).toFixed(0);\n  const button = DOM.download(\n    downloadData,\n    filename,\n    `Download ${filename} Dataset (~${size} KB)`\n  );\n  return button;\n}\n\nname = `${radio[0].drug} - ${radio[0].time}`\n\ndata2 = radio.map(d =&gt; ({...d, year: d.year2}))\n\ndata3 = data2.map(({year2, ...keep}) =&gt; keep)\n\ndownloadData1 = downloadButton(data3, name)\ndownloadData2 = downloadButton(data3, name)"
  },
  {
    "objectID": "bx-by/index.html",
    "href": "bx-by/index.html",
    "title": "MTF Main Dashboards",
    "section": "",
    "text": "Prevalence/Trends\n\n\nSubstance Use Prevalence and Trends among 8th, 10th, and 12th Graders\n\n\n\n\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "bx-by/drug-prevalence/documentation.html",
    "href": "bx-by/drug-prevalence/documentation.html",
    "title": "Documentation",
    "section": "",
    "text": "Code\nwideTable = html`\n&lt;style&gt;\n.branch {overflow-x:scroll; direction: rtl; margin-left:180px;  }\ntd:first-child, td:nth-child(2), th:first-child, th:nth-child(2) {position:absolute; width:100px; top:auto; white-space:normal;} \ntd:nth-child(1), th:first-child  {left: 110px; white-space:nowrap; word-wrap: break-word; }\ntd:nth-child(2), th:nth-child(2) {left: 210px; word-wrap: break-word;} \ntd, th { vertical-align: middle;  padding: .5em; color: black; }\nth { text-decoration: underline; white-space:nowrap; }  \ntr:nth-child(3) {\n  background-color: #ADD8E6;\n} \ntable {\n  direction: ltr;\n  border: none;\n  border-collapse: collapse;\n  text-align: center;\n}\n\n\n/* On screens that are 1720px or less, do this for the table and citation size */\n\n@media screen and (max-width: 1680px) {\n  .branch {overflow-x:scroll; direction: rtl; margin-left:170px;  }\ntd:first-child, td:nth-child(2), th:first-child, th:nth-child(2) {position:absolute; width:100px; top:auto; white-space:normal;} \ntd:nth-child(1), th:first-child  {left: 90px; white-space:nowrap; word-wrap: break-word; }\ntd:nth-child(2), th:nth-child(2) {left: 190px; word-wrap: break-word;}\ntr:nth-child(3) {\n  background-color: #ADD8E6;\n}\n}\n\n/* On screens that are 1720px or less, do this for the table */\n\n@media screen and (max-width: 1375px) {\n  .branch {overflow-x:scroll; direction: rtl; margin-left:160px;  }\ntd:first-child, td:nth-child(2), th:first-child, th:nth-child(2) {position:absolute; width:100px; top:auto; white-space:normal;} \ntd:nth-child(1), th:first-child  {left: 65px; white-space:nowrap; word-wrap: break-word; }\ntd:nth-child(2), th:nth-child(2) {left: 170px; word-wrap: break-word;}\ntr:nth-child(3) {\n  background-color: #ADD8E6;\n}\n}\n\n\n/* On screens that are 992px or less, do this for the table and citation size */\n\n@media screen and (max-width: 992px) {\n  .branch {overflow-x:scroll; direction: rtl; margin-left:155px;  }\ntd:first-child, td:nth-child(2), th:first-child, th:nth-child(2) {position:absolute; width:100px; top:auto; white-space:normal;} \ntd:nth-child(1), th:first-child  {left: 45px; white-space:nowrap; word-wrap: break-word; }\ntd:nth-child(2), th:nth-child(2) {left: 145px; word-wrap: break-word;}\ntr:nth-child(3) {\n  background-color: #ADD8E6;\n}\n}\n\n\n/* On screens that are 600px or less, do this for table and citation size */\n@media screen and (max-width: 600px) {\n  .branch {overflow-x:scroll; direction: rtl; margin-left:145px;  }\ntd:first-child, td:nth-child(2), th:first-child, th:nth-child(2) {position:absolute; width:100px; top:auto; white-space:normal;} \ntd:nth-child(1), th:first-child  {left: 25px; white-space:nowrap; word-wrap: break-word; }\ntd:nth-child(2), th:nth-child(2) {left: 115px; word-wrap: break-word;}\ntr:nth-child(3) {\n  background-color: #ADD8E6;\n}\n}\n&lt;/style&gt;\n&lt;table aria-label=\"${radio[0].drug}: Trends in ${radio[0].time} Prevalence of Use in Grades 8, 10, and 12\"&gt;\n  &lt;tr&gt;\n    &lt;th scope=\"col\"&gt;Report Interval&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;Grade&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1975&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1976&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1977&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1978&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1979&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1980&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1981&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1982&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1983&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1984&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1985&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1986&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1987&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1988&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1989&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1990&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1991&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1992&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1993&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1994&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1995&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1996&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1997&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1998&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1999&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2000&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2001&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2002&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2003&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2004&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2005&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2006&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2007&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2008&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2009&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2010&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2011&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2012&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2013&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2014&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2015&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2016&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2017&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2018&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2019&lt;sup&gt;ff&lt;/sup&gt;&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2020&lt;sup&gt;tt&lt;/sup&gt;&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2021&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2022&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2023&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2024&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2023-2024 &lt;br&gt; Change&lt;/th&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;${htmlTables[0]?.time}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?.grade}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1975}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1976}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1977}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1978}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1979}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1980}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1981}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1982}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1983}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1984}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1985}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1986}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1987}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1988}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1989}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1990}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1991}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1992}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1993}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1994}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1995}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1996}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1997}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1998}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1999}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2000}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2001}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2002}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2003}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2004}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2005}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2006}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2007}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2008}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2009}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2010}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2011}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2012}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2013}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2014}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2015}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2016}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2017}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2018}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2019}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2020}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2021}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2022}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2023}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2024}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?.changeEstimate}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;${htmlTables[1]?.time}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?.grade}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1975}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1976}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1977}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1978}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1979}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1980}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1981}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1982}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1983}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1984}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1985}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1986}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1987}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1988}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1989}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1990}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1991}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1992}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1993}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1994}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1995}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1996}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1997}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1998}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1999}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2000}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2001}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2002}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2003}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2004}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2005}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2006}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2007}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2008}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2009}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2010}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2011}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2012}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2013}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2014}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2015}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2016}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2017}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2018}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2019}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2020}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2021}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2022}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2023}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2024}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?.changeEstimate}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;${htmlTables[2]?.time}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?.grade}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1975}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1976}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1977}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1978}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1979}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1980}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1981}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1982}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1983}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1984}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1985}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1986}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1987}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1988}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1989}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1990}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1991}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1992}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1993}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1994}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1995}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1996}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1997}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1998}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1999}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2000}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2001}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2002}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2003}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2004}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2005}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2006}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2007}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2008}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2009}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2010}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2011}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2012}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2013}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2014}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2015}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2016}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2017}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2018}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2019}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2020}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2021}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2022}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2023}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2024}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?.changeEstimate}&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt;\n`\n\n\n\n\n\n\n\nIn ObservableJS you can embed HTML, the html with the two escape characters allows you to write anything that you could put within an HTML. Here I use CSS in the beginning to style the table and to make it responsive to screen size changes. Then I list out all of the estimates by connecting them to the htmlTables dataset. When we search for new drugs via the search input or change the reporting interval via the radio buttons it updates the dataset. The estimates change dynamically because of the ${} which inject the newly updated estimates via javascript. I named the code cell wideTable to use later on."
  },
  {
    "objectID": "bx-by/drug-prevalence/documentation.html#table-wide-format",
    "href": "bx-by/drug-prevalence/documentation.html#table-wide-format",
    "title": "Documentation",
    "section": "",
    "text": "Code\nwideTable = html`\n&lt;style&gt;\n.branch {overflow-x:scroll; direction: rtl; margin-left:180px;  }\ntd:first-child, td:nth-child(2), th:first-child, th:nth-child(2) {position:absolute; width:100px; top:auto; white-space:normal;} \ntd:nth-child(1), th:first-child  {left: 110px; white-space:nowrap; word-wrap: break-word; }\ntd:nth-child(2), th:nth-child(2) {left: 210px; word-wrap: break-word;} \ntd, th { vertical-align: middle;  padding: .5em; color: black; }\nth { text-decoration: underline; white-space:nowrap; }  \ntr:nth-child(3) {\n  background-color: #ADD8E6;\n} \ntable {\n  direction: ltr;\n  border: none;\n  border-collapse: collapse;\n  text-align: center;\n}\n\n\n/* On screens that are 1720px or less, do this for the table and citation size */\n\n@media screen and (max-width: 1680px) {\n  .branch {overflow-x:scroll; direction: rtl; margin-left:170px;  }\ntd:first-child, td:nth-child(2), th:first-child, th:nth-child(2) {position:absolute; width:100px; top:auto; white-space:normal;} \ntd:nth-child(1), th:first-child  {left: 90px; white-space:nowrap; word-wrap: break-word; }\ntd:nth-child(2), th:nth-child(2) {left: 190px; word-wrap: break-word;}\ntr:nth-child(3) {\n  background-color: #ADD8E6;\n}\n}\n\n/* On screens that are 1720px or less, do this for the table */\n\n@media screen and (max-width: 1375px) {\n  .branch {overflow-x:scroll; direction: rtl; margin-left:160px;  }\ntd:first-child, td:nth-child(2), th:first-child, th:nth-child(2) {position:absolute; width:100px; top:auto; white-space:normal;} \ntd:nth-child(1), th:first-child  {left: 65px; white-space:nowrap; word-wrap: break-word; }\ntd:nth-child(2), th:nth-child(2) {left: 170px; word-wrap: break-word;}\ntr:nth-child(3) {\n  background-color: #ADD8E6;\n}\n}\n\n\n/* On screens that are 992px or less, do this for the table and citation size */\n\n@media screen and (max-width: 992px) {\n  .branch {overflow-x:scroll; direction: rtl; margin-left:155px;  }\ntd:first-child, td:nth-child(2), th:first-child, th:nth-child(2) {position:absolute; width:100px; top:auto; white-space:normal;} \ntd:nth-child(1), th:first-child  {left: 45px; white-space:nowrap; word-wrap: break-word; }\ntd:nth-child(2), th:nth-child(2) {left: 145px; word-wrap: break-word;}\ntr:nth-child(3) {\n  background-color: #ADD8E6;\n}\n}\n\n\n/* On screens that are 600px or less, do this for table and citation size */\n@media screen and (max-width: 600px) {\n  .branch {overflow-x:scroll; direction: rtl; margin-left:145px;  }\ntd:first-child, td:nth-child(2), th:first-child, th:nth-child(2) {position:absolute; width:100px; top:auto; white-space:normal;} \ntd:nth-child(1), th:first-child  {left: 25px; white-space:nowrap; word-wrap: break-word; }\ntd:nth-child(2), th:nth-child(2) {left: 115px; word-wrap: break-word;}\ntr:nth-child(3) {\n  background-color: #ADD8E6;\n}\n}\n&lt;/style&gt;\n&lt;table aria-label=\"${radio[0].drug}: Trends in ${radio[0].time} Prevalence of Use in Grades 8, 10, and 12\"&gt;\n  &lt;tr&gt;\n    &lt;th scope=\"col\"&gt;Report Interval&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;Grade&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1975&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1976&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1977&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1978&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1979&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1980&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1981&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1982&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1983&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1984&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1985&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1986&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1987&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1988&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1989&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1990&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1991&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1992&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1993&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1994&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1995&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1996&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1997&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1998&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1999&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2000&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2001&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2002&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2003&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2004&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2005&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2006&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2007&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2008&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2009&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2010&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2011&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2012&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2013&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2014&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2015&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2016&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2017&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2018&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2019&lt;sup&gt;ff&lt;/sup&gt;&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2020&lt;sup&gt;tt&lt;/sup&gt;&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2021&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2022&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2023&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2024&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2023-2024 &lt;br&gt; Change&lt;/th&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;${htmlTables[0]?.time}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?.grade}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1975}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1976}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1977}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1978}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1979}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1980}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1981}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1982}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1983}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1984}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1985}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1986}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1987}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1988}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1989}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1990}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1991}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1992}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1993}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1994}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1995}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1996}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1997}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1998}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._1999}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2000}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2001}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2002}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2003}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2004}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2005}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2006}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2007}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2008}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2009}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2010}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2011}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2012}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2013}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2014}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2015}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2016}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2017}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2018}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2019}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2020}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2021}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2022}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2023}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?._2024}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]?.changeEstimate}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;${htmlTables[1]?.time}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?.grade}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1975}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1976}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1977}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1978}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1979}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1980}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1981}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1982}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1983}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1984}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1985}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1986}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1987}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1988}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1989}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1990}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1991}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1992}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1993}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1994}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1995}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1996}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1997}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1998}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._1999}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2000}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2001}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2002}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2003}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2004}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2005}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2006}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2007}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2008}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2009}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2010}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2011}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2012}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2013}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2014}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2015}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2016}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2017}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2018}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2019}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2020}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2021}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2022}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2023}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2024}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?.changeEstimate}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;${htmlTables[2]?.time}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?.grade}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1975}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1976}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1977}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1978}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1979}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1980}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1981}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1982}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1983}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1984}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1985}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1986}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1987}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1988}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1989}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1990}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1991}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1992}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1993}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1994}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1995}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1996}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1997}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1998}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._1999}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2000}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2001}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2002}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2003}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2004}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2005}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2006}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2007}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2008}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2009}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2010}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2011}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2012}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2013}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2014}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2015}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2016}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2017}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2018}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2019}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2020}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2021}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2022}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2023}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?._2024}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[2]?.changeEstimate}&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt;\n`\n\n\n\n\n\n\n\nIn ObservableJS you can embed HTML, the html with the two escape characters allows you to write anything that you could put within an HTML. Here I use CSS in the beginning to style the table and to make it responsive to screen size changes. Then I list out all of the estimates by connecting them to the htmlTables dataset. When we search for new drugs via the search input or change the reporting interval via the radio buttons it updates the dataset. The estimates change dynamically because of the ${} which inject the newly updated estimates via javascript. I named the code cell wideTable to use later on."
  },
  {
    "objectID": "bx-by/drug-prevalence/documentation.html#accordion-buttons",
    "href": "bx-by/drug-prevalence/documentation.html#accordion-buttons",
    "title": "Documentation",
    "section": "Accordion Buttons",
    "text": "Accordion Buttons\n\naccordionButtons = \nhtml`\n&lt;div style=\"width: 90%\" class=\"accordion accordion-flush\" id=\"accordionFlushExample\"&gt;\n  &lt;div class=\"accordion-item\"&gt;\n    &lt;h2 class=\"accordion-header\" id=\"flush-headingOne\"&gt;\n      &lt;button class=\"accordion-button collapsed\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#flush-collapseOne\" aria-expanded=\"false\" aria-controls=\"flush-collapseOne\"&gt;\n        Table with Detailed Estimates\n      &lt;/button&gt;\n    &lt;/h2&gt;\n    &lt;div id=\"flush-collapseOne\" class=\"accordion-collapse collapse\" aria-labelledby=\"flush-headingOne\" data-bs-parent=\"#accordionFlushExample\"&gt;\n      &lt;div class=\"accordion-body\"&gt;\n              &lt;div class=\"branch\"&gt;&lt;div&gt;${wideTable}&lt;/div&gt;&lt;/div&gt;\n                &lt;div&gt;\n                &lt;p style=\"font-size: small; margin-bottom: 0px;\"&gt;Note:\n                      Level of significance: *=p&lt;.05, **=p&lt;.01, ***=p&lt;.001. &lt;br&gt;\n                      \".\" indicates data is not available. &lt;br&gt;\n                      \"&Dagger;\" indicates that the question changed the following year. &lt;br&gt;\n                      \"&sect;\" indicates insufficient data for that year. &lt;br&gt;\n                      &lt;a href=\"https://monitoringthefuture.org/data/bx-by/drug-prevalence/Footnotes.pdf\"&gt;Footnotes (PDF)&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;\n                      \n          &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"accordion-item\"&gt;\n    &lt;h2 class=\"accordion-header\" id=\"flush-headingTwo\"&gt;\n      &lt;button class=\"accordion-button collapsed\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#flush-collapseTwo\" aria-expanded=\"false\" aria-controls=\"flush-collapseTwo\"&gt;\n        Commentary\n      &lt;/button&gt;\n    &lt;/h2&gt;\n    &lt;div id=\"flush-collapseTwo\" class=\"accordion-collapse collapse\" aria-labelledby=\"flush-headingTwo\" data-bs-parent=\"#accordionFlushExample\"&gt;\n      &lt;div style=\"display: flex; justify-content: center; width:100%\" class=\"accordion-body\"&gt;${publishdoc}&lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;`\n\n\n\n\n\n\nHere I am again using the html tag to embed some accordianButtons. Because Quarto uses Bootstrap for styling, I just need to add the class and id tags for the buttons to inherit the button styles. In addition, I use ${wideTable} to place the reactive html table code and ${editdoc} to place the linked google doc within the accordian buttons so that we will see it when we click on the button. I also link to a dataset that has all of the footnote letter superscripts for the prevalence figures ${googledoclink[0].Superscript} and updates according to the drug."
  },
  {
    "objectID": "bx-by/drug-prevalence/documentation.html#citation",
    "href": "bx-by/drug-prevalence/documentation.html#citation",
    "title": "Documentation",
    "section": "Citation",
    "text": "Citation\n\ncitation = html`&lt;div style=\"max-width: 750px;\"&gt;&lt;p style=\"font-size: small;\"&gt;Miech, R. A., Johnston, L. D., Patrick, M. E., & O’Malley, P. M. (2025). Monitoring the Future national survey results on drug use, 1975–2024: Overview and detailed results for secondary school students. Monitoring the Future Monograph Series. Ann Arbor, MI: Institute for Social Research, University of Michigan. Available at &lt;a href=\"https://monitoringthefuture.org/results/annual-reports/\"&gt;https://monitoringthefuture.org/results/annual-reports/&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;`\n\n\n\n\n\n\nHere is the citation section that links to the monographs on the Monitoring the Future website."
  },
  {
    "objectID": "bx-by/drug-prevalence/documentation.html#footnotes",
    "href": "bx-by/drug-prevalence/documentation.html#footnotes",
    "title": "Documentation",
    "section": "Footnotes",
    "text": "Footnotes\n\nfootnotes = html`&lt;p style=\"font-size: small;\"&gt;&lt;span style=\"color:#ff57f9; font-weight:500;\"&gt;2023-2024 Change Level of Significance: *=p&lt;.05, **=p&lt;.01, ***=p&lt;.001.&lt;/span&gt; &lt;br&gt; &lt;a href=\"https://monitoringthefuture.org/data/bx-by/drug-prevalence/Footnotes.pdf\"&gt;Footnotes (PDF)&lt;/a&gt;&lt;/p&gt;`\n\n\n\n\n\n\nThis is the footnote uses the same ${googledoclink[0].Superscript} to update the letter according to which drug is searched."
  },
  {
    "objectID": "bx-by/drug-prevalence/documentation.html#commentary-data",
    "href": "bx-by/drug-prevalence/documentation.html#commentary-data",
    "title": "Documentation",
    "section": "Commentary Data",
    "text": "Commentary Data\n\ndrugCommentary = FileAttachment(\"drug-commentary.csv\").csv()\n\ngoogledoclink = drugCommentary.filter(\n  ({ DrugName }) =&gt; DrugName.toLocaleLowerCase() === select.toLocaleLowerCase()\n)\n\neditdoc = html`&lt;iframe width=\"100%\" height=\"800px\" src=${googledoclink[0].EditLink}&gt;&lt;/iframe&gt;`\npublishdoc = html`&lt;iframe style=\"width:900px; height:1300px;\"src=${googledoclink[0].PublishLink}&gt;&lt;/iframe&gt;`\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThis is where the commentary dataset lives. It is set up to filter by DrugName via the search input. This houses the links to both the editable and the published google docs organized by drug name. In addition it has each footnote letter organized by drug name. I named each version of google doc so that I can easily switch between them."
  },
  {
    "objectID": "bx-by/drug-prevalence/documentation.html#table-data",
    "href": "bx-by/drug-prevalence/documentation.html#table-data",
    "title": "Documentation",
    "section": "Table Data",
    "text": "Table Data\n\ntables = FileAttachment(\"tabledata.csv\").csv({ typed: true })\ntables2 = FileAttachment(\"tabledata.csv\").csv()\n\ntablesDrug = tables.filter(\n  ({ drug }) =&gt; drug.toLocaleLowerCase() === select.toLocaleLowerCase()\n)\ntablesDrug2 = tables2.filter(\n  ({ drug }) =&gt; drug.toLocaleLowerCase() === select.toLocaleLowerCase()\n)\n\ntablesDrugTime = tablesDrug.filter(({ time }) =&gt; time === radio[0].time)\ntablesDrugTime2 = tablesDrug2.filter(({ time }) =&gt; time === radio[0].time)\n\ntablesDrug2\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntablesDrugTime\n\n\n\n\n\n\n\ntablesDrugTime2\n\n\n\n\n\n\n\nhtmlTables = tablesDrugTime2\n\nhtmlTables\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThis is the data in wide format for the HTML tables. It is filtered by both Drug name and by Time reporting interval. I had to do it twice because one needs to be read by the graph for the asterisks and one needs to be displayed in the HTML tables. For some reason (still not 100% sure why) in order for the negative numbers to show in the HTML tables it needs to be untyped."
  },
  {
    "objectID": "bx-by/drug-prevalence/documentation.html#plot-data",
    "href": "bx-by/drug-prevalence/documentation.html#plot-data",
    "title": "Documentation",
    "section": "Plot Data",
    "text": "Plot Data\n\nprevalence = FileAttachment(\"plotdata.csv\").csv({ typed: true })\n\nprevalence\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nparser = d3.timeParse(\"%Y\")\n\ndata = { // This creates new variables\n  const subset = prevalence.map(\n    ({ drug, time, grade, year, estimate, LBYear1, LBYear2 }) =&gt; ({\n      drug: drug,\n      time: time,\n      grade: grade,\n      year: parser(year),\n      estimate: +estimate.toFixed(1),\n      LBYear1: parser(LBYear1),\n      LBYear2: parser(LBYear2)\n    })\n  );\n\n  return subset.filter(\n    ({ drug }) =&gt; drug.toLocaleLowerCase() === select.toLocaleLowerCase()\n  );\n}\n\ndata\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThis is the data for the Plot. I attach the .csv file and use .csv({ typed: true }) to try to have ObservableJS guess the data types of each of the variables. I do some data management to set it up to be read by Observable Plot the data visualization library. I name a time parser function parser = d3.timeParse(\"%Y\") that I use later on to change the year variable from a number to a date year: parser(year) in addition I created two more variables to denote when there needs to be a line break LBYear1 and LBYear1. I coerce the estimate variable into a number and round it to the tenths place estimate: +estimate.toFixed(1). Then after I rewrite my variables I set the data to filter based on the drug name by the search input."
  },
  {
    "objectID": "bx-by/drug-prevalence/documentation.html#search-bar",
    "href": "bx-by/drug-prevalence/documentation.html#search-bar",
    "title": "Documentation",
    "section": "Search Bar",
    "text": "Search Bar\n\nimport {PersistInput} from \"@john-guerra/persist-input\"\nimport {aq, op} from \"@uwdata/arquero\"\n\nviewof drugs = aq // viewof shows the table view, but assigns the table value\n  .fromCSV(await FileAttachment(\"plotdata.csv\").text())\n  .groupby(\"drug\")\n  .count()\n  .view({ height: 240 })\n\ndrugSelection = drugs.objects()\n\nviewof search = PersistInput( // This creates a reactive input called search\n  \"drug\", form2)\n\n form2 = {\n  const form = Inputs.text({\n    datalist: drugSelection.map((d) =&gt; d.drug),\n    placeholder: \"Search Drug\",\n    submit: true,\n    autocomplete: false,\n    spellcheck: true,\n    width: 300\n  }); \n    form.addEventListener(\"input\", () =&gt; {form.text.value = \"\"});\n  return form;}\n\nselect = search ? search : \"Alcohol\"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nHere I import a function from this notebook to create a persistent URL hash based on the drug name that allows users to copy the URL and share a specific drug. For example, searching for Adderall would create #drug=\"Adderall\" at the end of the URL that allows you to share the dashboard with the relevant Adderall information. I also imported the Aquero Library which is a data management library for JavaScript similar to R’s Tidyverse package. I group the data by drug with .groupby(\"drug\") and create a list of drug names to choose from with drugSelection = drugs.objects() and datalist: drugSelection.map((d) =&gt; d.drug). The viewof in front of search is unique to ObservableJS. It allows you to pair inputs with values. Here is more information on views.. Lastly, I create a if statement with a ternary operator. So that if the search bar is empty, the value for the drug name defaults to Alcohol. Otherwise if there is a value submitted in the search bar it will default to that value."
  },
  {
    "objectID": "bx-by/drug-prevalence/documentation.html#radio-buttons",
    "href": "bx-by/drug-prevalence/documentation.html#radio-buttons",
    "title": "Documentation",
    "section": "Radio Buttons",
    "text": "Radio Buttons\n\nviewof radio = {\n  const values = d3.group(data, (d) =&gt; d.time);\n  return Inputs.radio(values, {\n    key: values.has(\"12 Month\")\n      ? \"12 Month\"\n      : values.keys().next().value\n  });\n}\n\nradio\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThis is another input called radio it uses the plot data to extract the different time periods as options. This sets Last 12 Months as the default reporting interval. If there is no Last 12 Months value, then it selects the next value within that drug’s set of reporting intervals. The viewof allows me to use the filtered data by reporting interval which I will refer to later on."
  },
  {
    "objectID": "bx-by/drug-prevalence/documentation.html#zoom-in-button",
    "href": "bx-by/drug-prevalence/documentation.html#zoom-in-button",
    "title": "Documentation",
    "section": "Zoom-in Button",
    "text": "Zoom-in Button\n\nfunction buttonToggle({ \n  onText = \"Zoom in\",\n  offText = \"Zoom out\",\n  value = 0,\n  click = (value, clicks) =&gt; clicks\n} = {}) {\n  let text = onText,\n    ml = html`&lt;button type=\"button\" class=\"btn btn-quarto\" &gt;${text}&lt;/button&gt;`,\n    clicks = 0,\n    v = value;\n\n  ml.value = v;\n  ml.onclick = () =&gt; {\n    v = click(v, ++clicks);\n\n    ml.value = v;\n    ml.innerHTML = clicks % 2 === 0 ? onText : offText;\n  };\n  return ml;\n}\n\nmax = Math.max(...radio.map((o) =&gt; o.estimate))\n\nyscale = {\n  if (zoomInButton % 2 == 0) {\n    return [0, 100]; // If this statement is true, return this\n  } else {\n    return [0, max]; // If the second statement is true, return this\n  }\n}\n\nviewof zoomInButton = buttonToggle()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThis is a function to create the Zoom in button. It basically updates the Y Axis of the graph from the default of 100 as the max to whatever the max is of the current drug and reporting interval. The buttonToggle creates a value (either even or odd) when clicked that changes the name of the button and is used within the yscale if statement that returns either the full scale of 100 or that drug’s max estimate. To get the max estimate max = Math.max(...radio.map((o) =&gt; o.estimate)) It takes the radio dataset that is filtered by both drug name and time reporting interval and finds the max value via the Math.max() function bult-in to JavaScript. Then I use the viewof operator to be able to name the input and import it."
  },
  {
    "objectID": "bx-by/drug-prevalence/documentation.html#download-data-button",
    "href": "bx-by/drug-prevalence/documentation.html#download-data-button",
    "title": "Documentation",
    "section": "Download Data Button",
    "text": "Download Data Button\n\ndownloadButton = (data, filename) =&gt; {\n  \n  let downloadData;\n  downloadData = new Blob([d3.csvFormat(data)], { type: \"text/csv\" });\n  const size = (downloadData.size / 1024).toFixed(0);\n  const button = DOM.download(\n    downloadData,\n    filename,\n    `Download ${filename} Dataset (~${size} KB)`\n  );\n  return button;\n}\n\nname = `${radio[0].drug} - ${radio[0].time}`\n\nradioWithoutLineBreaks = radio.map(obj =&gt; {\n  const {year, estimate, drug, grade, time} = obj;\n  return {year, estimate, drug, grade, time};\n});\n\ndownloadData = downloadButton(radioWithoutLineBreaks, name)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ndownloadButton is a function that takes an array of data as the first argument and the name you want to call the file as the second argument. It displays the filename and the size of the file in kilobytes."
  },
  {
    "objectID": "bx-by/drug-prevalence/documentation.html#plot-title",
    "href": "bx-by/drug-prevalence/documentation.html#plot-title",
    "title": "Documentation",
    "section": "Plot Title",
    "text": "Plot Title\n\ntitle = html`&lt;h3&gt; ${radio[0].drug.toLocaleUpperCase()}: Trends in &lt;u&gt;${radio[0].time}&lt;/u&gt; Prevalence of Use in ${gradeQuestion} &lt;/h3&gt;`\n\ngradeQuestion = gradeTitle.length &gt; 1\n  ? \"8th, 10th, and 12th Grade\"\n  : \"12th Grade\"\n\nradioSet = new Set(radio.map((d) =&gt; d.grade))\n\ngradeTitle = [...radioSet]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThis creates the title of the plot by reactively updating via the radio data set. First is the drug name ${radio[0].drug} then the reporting interval ${radio[0].time} then whether it is all grades or just 12th grade ${gradeQuestion}. That variable is just a ternary operator that figures out if there is more than one grade variable."
  },
  {
    "objectID": "bx-by/drug-prevalence/documentation.html#rendered-plot",
    "href": "bx-by/drug-prevalence/documentation.html#rendered-plot",
    "title": "Documentation",
    "section": "Rendered Plot",
    "text": "Rendered Plot\n\nimport {addTooltips} from \"@mkfreeman/plot-tooltip\"\n\nformatter = d3.timeFormat(\"%Y\")\n\ncolor = d3.scaleOrdinal(\n  [\"8th Grade\", \"10th Grade\", \"12th Grade\"],\n  [\"#59bbeb\", \"#6ac4a1\", \"#cca438\"]\n)\n\nsymbol = d3.scaleOrdinal(\n  [\"8th Grade\", \"10th Grade\", \"12th Grade\"],\n  [\"circle\", \"square\", \"triangle\"]\n)\n\ngradeOrder = [\"8th Grade\", \"10th Grade\", \"12th Grade\"];\n\nradio.sort((a, b) =&gt; gradeOrder.indexOf(a.grade) - gradeOrder.indexOf(b.grade));\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nplot = addTooltips(\n  Plot.plot({\n    ariaLabel: \"Drug Prevalence Line Charts\",\n    ariaDescription:\n      \"Drug Prevalence Chart showing estimates of use over time (1975 to 2024) in 8th, 10th, and 12th grade filtered by drug name and reporting interval. Currently showing ${radio[0].drug}\",\n    width: 900,\n    height: 570,\n    marginBottom: 50,\n    style: {\n      overflow: \"visible\",\n      fontSize: 12\n    },\n    symbol: {\n      domain: new Set(radio.map((d) =&gt; d.grade)),\n      range: [...new Set(radio.map((d) =&gt; d.grade))].map(symbol),\n      legend: true,\n      swatchSize: 23\n    },\n    color: {\n      domain: new Set(radio.map((d) =&gt; d.grade)),\n      range: [...new Set(radio.map((d) =&gt; d.grade))].map(color)\n    },\n    y: {\n      label: \"Percentage (%)\",\n      labelAnchor: \"center\",\n      domain: yscale\n    },\n    x: {\n      type: \"time\",\n      domain: [new Date(\"1974-01-01\"), new Date(\"2024-01-01\")],\n      label: \"Years\",\n      labelAnchor: \"center\"\n    },\n    marks: [\n      Plot.ruleY([0]),\n      Plot.dot(radio, {\n        r: 5,\n        x: \"year\",\n        y: \"estimate\",\n        symbol: \"grade\",\n        fill: \"grade\",\n        title: (d) =&gt; `${d.grade} \\n ${formatter(d.year)}: ${d.estimate}%`\n      }),\n      Plot.line(radio, {\n        x: \"year\",\n        y: \"estimate\",\n        z: (d) =&gt; // This creates the line breaks\n          [\n            d.grade,\n            d.LBYear1 === null\n              ? d.year.getUTCFullYear() &gt; 1974\n              : d.year.getUTCFullYear() &gt; d.LBYear1.getUTCFullYear(),\n            d.LBYear2 === null\n              ? d.year.getUTCFullYear() &gt; 1974\n              : d.year.getUTCFullYear() &gt; d.LBYear2.getUTCFullYear()\n          ].join(),\n        stroke: \"grade\"\n      }),\n      Plot.text(\n        radio.filter((d) =&gt; d.grade === \"8th Grade\"),\n        Plot.selectLast({\n          x: \"year\",\n          y: \"estimate\",\n          text: (d) =&gt;\n            `${tablesDrugTime[0].plotSig === null ? \" \" : tablesDrugTime[0].plotSig}`, // This is the label that displays in the tooltip\n          textAnchor: \"start\",\n          fill: \"#ff57f9\",\n          fontSize: 20,\n          fontWeight: 800,\n          dx: 10\n        })\n      ),\n      Plot.text(\n        radio.filter((d) =&gt; d.grade === \"10th Grade\"),\n        Plot.selectLast({\n          x: \"year\",\n          y: \"estimate\",\n          text: (d) =&gt;\n            `${tablesDrugTime[1].plotSig === null ? \" \" : tablesDrugTime[1].plotSig}`,\n          textAnchor: \"start\",\n          fill: \"#ff57f9\",\n          fontSize: 20,\n          fontWeight: 800,\n          dx: 10\n        })\n      ),\n      Plot.text(\n        radio.filter((d) =&gt; d.grade === \"12th Grade\"),\n        Plot.selectLast({\n          x: \"year\",\n          y: \"estimate\",\n          text: (d) =&gt;\n            `${tablesDrugTime[2]?.plotSig == null ? \" \" : tablesDrugTime[2].plotSig}`,\n          textAnchor: \"start\",\n          fill: \"#ff57f9\",\n          fontSize: 20,\n          fontWeight: 800,\n          dx: 10\n        })\n      )\n    ]\n  }),\n  { fill: \"grade\" }\n)\n\n\n\n\n\n\n\n\nHere I import a tooltip via this notebook Observable has created new tooltips since I wrote this code. So I may go back and change it but for now I am still using the imported addTooltip() function. I create the color and symbol scales for the grades and name a function to format the year. Then I create three functions that check if the results of the significance test within the htmlTable dataset have astersisk. If they do then I display them in the graph. If they don’t nothing is displayed. For more on how the graph is made check out Observable Plot."
  },
  {
    "objectID": "bx-by/drug-prevalence/documentation.html#diverging-bar-chart",
    "href": "bx-by/drug-prevalence/documentation.html#diverging-bar-chart",
    "title": "Documentation",
    "section": "Diverging Bar Chart",
    "text": "Diverging Bar Chart\n\nsigdata = FileAttachment(\"sigbarchart.csv\").csv({typed: true})\n  .then(data =&gt; data.map((d) =&gt; ({...d, value: (d[2023] - d[2024]) / d[2024]})))\n\nsigDrug = sigdata.filter(\n  ({ drug }) =&gt; drug.toLocaleLowerCase() === select.toLocaleLowerCase()\n)\n\nsigDrugTime = sigDrug.filter(({ time }) =&gt; time === radio[0].time)\n\nsigDrugTime\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nsigmax = Math.max(...sigdata.map((o) =&gt; o._1_Year_Chg))\nsigmin = Math.min(...sigdata.map((o) =&gt; o._1_Year_Chg))\n\nsigbarChart = Plot.plot({\n  label: null,\n  marginLeft: 100,\n  marginRight: 100,\n  marginTop: 50,\n  style: {\n    overflow: \"visible\",\n    fontSize: 12\n  },\n  x: {\n    axis: \"top\",\n    label: \"← decrease · 1-Year Change in Drug Use, 2023–2024 · increase →\",\n    labelAnchor: \"center\",\n    domain: [sigmin, sigmax]\n  },\n  y: {\n    domain: [\"8th Grade\", \"10th Grade\", \"12th Grade\"]\n  },\n  color: {\n    scheme: \"PiYG\",\n    type: \"ordinal\"\n  },\n  marks: [\n    Plot.barX(sigDrugTime, {\n      x: \"_1_Year_Chg\",\n      y: \"grade\",\n      fill: (d) =&gt; d._1_Year_Chg &gt; 0\n    }),\n    Plot.gridX({ stroke: \"white\", strokeOpacity: 0.5 }),\n    d3\n      .groups(sigDrugTime, (d) =&gt; d._1_Year_Chg &gt; 0)\n      .map(([growth, grades]) =&gt; [\n        Plot.axisY({\n          x: 0,\n          ticks: grades.map((d) =&gt; d.grade),\n          tickSize: 0,\n          anchor: growth ? \"left\" : \"right\"\n        }),\n        Plot.textX(grades, {\n          x: \"_1_Year_Chg\",\n          y: \"grade\",\n          text: \"_1_Year_Chg\",\n          textAnchor: growth ? \"start\" : \"end\",\n          dx: growth ? 4 : -4,\n        })\n      ]),\n    Plot.textX(tablesDrugTime, {\n      x: \"_1_Year_Chg\",\n      y: \"grade\",\n      text: \"plotSig\"\n    }),\n    Plot.ruleX([0])\n  ]\n})"
  },
  {
    "objectID": "bx-by/drug-prevalence/barChart.html",
    "href": "bx-by/drug-prevalence/barChart.html",
    "title": "Prevalence/Trends",
    "section": "",
    "text": "import {\n  plot,\n  sigbarChart,\n  title,\n  downloadData,\n  citation,\n  footnotes,\n  accordionButtons,\n  viewof search,\n  viewof zoomInButton,\n  viewof radio\n} from \"./documentation.qmd\"\n\nhtml`&lt;div style=\"display: flex; gap: 3em\"&gt; ${viewof zoomInButton} ${viewof search} &lt;/div&gt;`\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nviewof radio\n\n\n\n\n\n\n\ntitle\n\n\n\n\n\n\n\nplot\n\n\n\n\n\n\n\ncitation\n\n\n\n\n\n\n\nsigbarChart\n\n\n\n\n\n\n\nfootnotes\n\n\n\n\n\n\n\ndownloadData\n\n\n\n\n\n\n\naccordionButtons"
  },
  {
    "objectID": "bx-by/drug-prevalence/index.html",
    "href": "bx-by/drug-prevalence/index.html",
    "title": "Prevalence/Trends",
    "section": "",
    "text": "import {\n  plot,\n  title,\n  downloadData,\n  citation,\n  footnotes,\n  accordionButtons,\n  viewof search,\n  viewof zoomInButton,\n  viewof radio\n} from \"./documentation.qmd\"\n\nhtml`&lt;div style=\"display: flex; gap: 3em\"&gt; ${viewof zoomInButton} ${viewof search} &lt;/div&gt;`\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nviewof radio\n\n\n\n\n\n\n\ntitle\n\n\n\n\n\n\n\nplot\n\n\n\n\n\n\n\ncitation\n\n\n\n\n\n\n\nfootnotes\n\n\n\n\n\n\n\ndownloadData\n\n\n\n\n\n\n\naccordionButtons"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Monitoring the Future Dashboards",
    "section": "",
    "text": "MTF Main Dashboards\n\n\nCross-sectional surveys of 8th, 10th, and 12th Graders.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nMTF Panel Dashboards\n\n\nLongitudinal study of adults aged 19 to 65.\n\n\n\n\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "panel/college-noncollege/index.html",
    "href": "panel/college-noncollege/index.html",
    "title": "College Students",
    "section": "",
    "text": "import {\n viewof select,\n viewof radio,\n  combocollegePlot,\n  combosexPlot,\n  downloadData1,\n  downloadData2,\n  citation1,\n  citation2\n} from \"./documentation.qmd\"\n\n\n\n\n\n\n\n\nviewof select\n\n\n\n\n\n\n\nviewof radio\n\n\n\n\n\n\n\n\n\nhtml`&lt;h3&gt; Trends in &lt;u&gt;${radio[0].time}&lt;/u&gt; Prevalence Among Respondents 1 to 4 Years Beyond High School&lt;/h3&gt; &lt;br&gt;`\n\n\n\n\n\n\n\nSexCollege vs. Noncollege\n\n\n\nhtml`&lt;div&gt; ${combosexPlot} &lt;/div&gt;`\n\n\n\n\n\n\n\nhtml`&lt;div&gt; ${citation1} &lt;/div&gt;`\n\n\n\n\n\n\n\ndownloadData1\n\n\n\n\n\n\n\n\n\n\n\nhtml`&lt;div&gt; ${combocollegePlot} &lt;/div&gt;`\n\n\n\n\n\n\n\nhtml`&lt;div&gt; ${citation2} &lt;/div&gt;`\n\n\n\n\n\n\n\ndownloadData2"
  },
  {
    "objectID": "panel/demographic-subgroups/index.html",
    "href": "panel/demographic-subgroups/index.html",
    "title": "Demographic Subgroups",
    "section": "",
    "text": "import {\n viewof select,\n viewof radio,\n viewof radio1,\n  downloadData1,\n  downloadData2,\n  comboracePlot,\n  combosexPlot,\n  citation1,\n  citation2\n} from \"./documentation.qmd\"\n\n\n\n\n\n\n\nviewof select\nviewof radio\nviewof radio1\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nhtml` &lt;h3&gt; Trends in &lt;u&gt;${radio[0].time}&lt;/u&gt; Prevalence Among Respondents of Modal ${radio1[0].age} &lt;/h3&gt; &lt;br&gt;`\n\n\n\n\n\n\n\nSexRace/Ethnicity\n\n\n\nhtml`&lt;div&gt; ${combosexPlot} &lt;/div&gt;`\n\n\n\n\n\n\n\nhtml`&lt;div&gt; ${citation1} &lt;/div&gt;`\n\n\n\n\n\n\n\ndownloadData1\n\n\n\n\n\n\n\n\n\n\n\nhtml`&lt;div&gt; ${comboracePlot} &lt;/div&gt;`\n\n\n\n\n\n\n\nhtml`&lt;div&gt; ${citation2} &lt;/div&gt;`\n\n\n\n\n\n\n\ndownloadData2"
  },
  {
    "objectID": "panel/substance-use/documentation.html",
    "href": "panel/substance-use/documentation.html",
    "title": "Documentation",
    "section": "",
    "text": "sigData = FileAttachment(\"chapter2_sigtests.csv\").csv({ typed: true })\n\nsigsDrug = sigData.filter(\n  ({ drug }) =&gt; drug === select\n)\n\nsignificance = sigsDrug.filter(({ time }) =&gt; time === radio[0].time)\nsignificance"
  },
  {
    "objectID": "panel/substance-use/documentation.html#significance-tests",
    "href": "panel/substance-use/documentation.html#significance-tests",
    "title": "Documentation",
    "section": "",
    "text": "sigData = FileAttachment(\"chapter2_sigtests.csv\").csv({ typed: true })\n\nsigsDrug = sigData.filter(\n  ({ drug }) =&gt; drug === select\n)\n\nsignificance = sigsDrug.filter(({ time }) =&gt; time === radio[0].time)\nsignificance"
  },
  {
    "objectID": "panel/substance-use/documentation.html#significance-legend-in-graph",
    "href": "panel/substance-use/documentation.html#significance-legend-in-graph",
    "title": "Documentation",
    "section": "Significance Legend in Graph",
    "text": "Significance Legend in Graph\n\nsigLegend1 = html`&lt;style&gt;\n    caption {\n      font-size: 9px;\n    }\n\n    table {\n      margin-bottom: 0.5rem;\n    }\n\n    .small td {\n        font-size: 9px;\n        color: #000066;\n    }\n\n&lt;/style&gt;\n&lt;table class=\"small\" style=\"width: 250px; \"&gt;\n  &lt;caption style=\"color: #000066;\"&gt; &lt;b&gt;&lt;u&gt;2023 Trends&lt;/b&gt;&lt;/u&gt; &lt;/caption&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Ages 19-30&lt;/td&gt;\n    &lt;td&gt;1-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.oneyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.sig_oneyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt; &lt;/td&gt;\n    &lt;td&gt;5-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.fiveyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.sig_fiveyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr style=\"background-color: white;\"&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;10-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.tenyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.sig_tenyr}&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt;`\n\n\nsigLegend2 = html`&lt;style&gt;\n    caption {\n      font-size: 9px;\n    }\n\n    table {\n      margin-bottom: 0.5rem;\n    }\n\n   .small td {\n        font-size: 9px;\n        color: #000066;\n    }\n\n&lt;/style&gt;\n&lt;table class=\"small\" style=\"width: 250px; \"&gt;\n  &lt;caption style=\"color: #000066;\"&gt; &lt;b&gt;&lt;u&gt;2023 Trends&lt;/b&gt;&lt;/u&gt; &lt;/caption&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Ages 19-30&lt;/td&gt;\n    &lt;td&gt;1-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.oneyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.sig_oneyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt; &lt;/td&gt;\n    &lt;td&gt;5-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.fiveyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.sig_fiveyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr style=\"background-color: white;\"&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;10-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.tenyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[0]?.sig_tenyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Ages 35-50&lt;/td&gt;\n    &lt;td&gt;1-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.oneyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.sig_oneyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt; &lt;/td&gt;\n    &lt;td&gt;5-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.fiveyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.sig_fiveyr}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;10-Year Change&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.tenyrchange}&lt;/td&gt;\n    &lt;td&gt;${significance[1]?.sig_tenyr}&lt;/td&gt;\n  &lt;/tr&gt;\n   &lt;tr&gt;\n    &lt;td&gt;Ages 55-65&lt;/td&gt;\n    &lt;td&gt;1-Year Change&lt;/td&gt;\n    &lt;td&gt;.&lt;/td&gt;\n    &lt;td&gt;N/A&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt; &lt;/td&gt;\n    &lt;td&gt;5-Year Change&lt;/td&gt;\n    &lt;td&gt;.&lt;/td&gt;\n    &lt;td&gt;N/A&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;10-Year Change&lt;/td&gt;\n    &lt;td&gt;.&lt;/td&gt;\n    &lt;td&gt;N/A&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt;`\n\nsigLegend = significance[1]?.oneyrchange === undefined ? sigLegend1 : sigLegend2\n\nlegendPlace = {if (radio[0]?.drug == \"Alcohol\" && radio[0]?.time == \"12 Month\"){\n  return \"bottom: 60px; right: 50px;\";\n} else if (radio[0]?.drug == \"Alcohol\" && radio[0]?.time == \"Lifetime\") {\n  return \"bottom: 60px; right: 50px;\";\n} else if (radio[0]?.drug == \"Alcohol\" && radio[0]?.time == \"30 Day\") {\n  return \"bottom: 60px; right: 50px;\";\n} else {\n  return \"top: 50px; right: 50px;\";\n}\n}\n\nlegendPlace"
  },
  {
    "objectID": "panel/substance-use/documentation.html#table-wide-format",
    "href": "panel/substance-use/documentation.html#table-wide-format",
    "title": "Documentation",
    "section": "Table Wide Format",
    "text": "Table Wide Format\n\n\nCode\nwideTable = html`\n&lt;style&gt;\n.branch {overflow-x:scroll; direction: rtl; margin-left:200px;  }\n \ntd:nth-child(1), th:first-child  { left: 110px; white-space:nowrap; word-wrap: break-word; }\ntd:nth-child(2), th:nth-child(2) { left: 210px; word-wrap: break-word;} \ntd, th { vertical-align: middle;  padding: .5em; color: black; }\nth { text-decoration: underline; white-space:nowrap; }  \ntr:nth-child(3) {\n  background-color: #ADD8E6;\n} \n\n.sticky {position:absolute; width:100px; top:auto; white-space:normal;} \n\ntable {\n  direction: ltr;\n  border: none;\n  border-collapse: collapse;\n  text-align: center;\n}\n\n\n/* On screens that are 1720px or less, do this for the table and citation size */\n\n@media screen and (max-width: 1680px) {\n  .branch {overflow-x:scroll; direction: rtl; margin-left:190px;  }\ntd:nth-child(1), th:first-child  {left: 90px; white-space:nowrap; word-wrap: break-word; }\ntd:nth-child(2), th:nth-child(2) {left: 190px; word-wrap: break-word;}\ntr:nth-child(3) {\n  background-color: #ADD8E6;\n}\n}\n\n/* On screens that are 1720px or less, do this for the table */\n\n@media screen and (max-width: 1375px) {\n  .branch {overflow-x:scroll; direction: rtl; margin-left:180px;  } \ntd:nth-child(1), th:first-child  {left: 65px; white-space:nowrap; word-wrap: break-word; }\ntd:nth-child(2), th:nth-child(2) {left: 170px; word-wrap: break-word;}\ntr:nth-child(3) {\n  background-color: #ADD8E6;\n}\n}\n\n\n/* On screens that are 992px or less, do this for the table and citation size */\n\n@media screen and (max-width: 992px) {\n  .branch {overflow-x:scroll; direction: rtl; margin-left:175px;  } \ntd:nth-child(1), th:first-child  {left: 45px; white-space:nowrap; word-wrap: break-word; }\ntd:nth-child(2), th:nth-child(2) {left: 145px; word-wrap: break-word;}\ntr:nth-child(3) {\n  background-color: #ADD8E6;\n}\n}\n\n\n/* On screens that are 600px or less, do this for table and citation size */\n@media screen and (max-width: 600px) {\n  .branch {overflow-x:scroll; direction: rtl; margin-left:155px;  } \ntd:nth-child(1), th:first-child  {left: 25px; white-space:nowrap; word-wrap: break-word; }\ntd:nth-child(2), th:nth-child(2) {left: 115px; word-wrap: break-word;}\ntr:nth-child(3) {\n  background-color: #ADD8E6;\n}\n}\n&lt;/style&gt;\n&lt;table aria-label=\"${radio[0].drug}: Trends in ${radio[0].time} Prevalence of Use in 19-30 and 35-50 year olds\"&gt;\n  &lt;tr&gt;\n    &lt;th class=\"sticky\" scope=\"col\"&gt;Report Interval&lt;/th&gt;\n    &lt;th class=\"sticky\" scope=\"col\"&gt;Age&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1988&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1989&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1990&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1991&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1992&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1993&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1994&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1995&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1996&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1997&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1998&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;1999&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2000&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2001&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2002&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2003&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2004&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2005&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2006&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2007&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2008&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2009&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2010&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2011&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2012&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2013&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2014&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2015&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2016&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2017&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2018&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2019&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2020&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2021&lt;/th&gt;\n    &lt;th scope=\"col\"&gt;2022&lt;/th&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td class=\"sticky\" &gt;${htmlTables[0]?.time == undefined ? \"-\" : htmlTables[0]?.time}&lt;/td&gt;\n    &lt;td class=\"sticky\" &gt;${htmlTables[0]?.age == undefined ? \"-\" : htmlTables[0]?.age}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._1988 == \"NaN\" ? \"-\" : htmlTables[0]._1988}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._1989 == \"NaN\" ? \"-\" : htmlTables[0]._1989}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._1990 == \"NaN\" ? \"-\" : htmlTables[0]._1990}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._1991 == \"NaN\" ? \"-\" : htmlTables[0]._1991}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._1992 == \"NaN\" ? \"-\" : htmlTables[0]._1992}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._1993 == \"NaN\" ? \"-\" : htmlTables[0]._1993}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._1994 == \"NaN\" ? \"-\" : htmlTables[0]._1994}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._1995 == \"NaN\" ? \"-\" : htmlTables[0]._1995}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._1996 == \"NaN\" ? \"-\" : htmlTables[0]._1996}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._1997 == \"NaN\" ? \"-\" : htmlTables[0]._1997}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._1998 == \"NaN\" ? \"-\" : htmlTables[0]._1998}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._1999 == \"NaN\" ? \"-\" : htmlTables[0]._1999}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._2000 == \"NaN\" ? \"-\" : htmlTables[0]._2000}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._2001 == \"NaN\" ? \"-\" : htmlTables[0]._2001}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._2002 == \"NaN\" ? \"-\" : htmlTables[0]._2002}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._2003 == \"NaN\" ? \"-\" : htmlTables[0]._2003}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._2004 == \"NaN\" ? \"-\" : htmlTables[0]._2004}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._2005 == \"NaN\" ? \"-\" : htmlTables[0]._2005}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._2006 == \"NaN\" ? \"-\" : htmlTables[0]._2006}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._2007 == \"NaN\" ? \"-\" : htmlTables[0]._2007}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._2008 == \"NaN\" ? \"-\" : htmlTables[0]._2008}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._2009 == \"NaN\" ? \"-\" : htmlTables[0]._2009}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._2010 == \"NaN\" ? \"-\" : htmlTables[0]._2010}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._2011 == \"NaN\" ? \"-\" : htmlTables[0]._2011}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._2012 == \"NaN\" ? \"-\" : htmlTables[0]._2012}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._2013 == \"NaN\" ? \"-\" : htmlTables[0]._2013}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._2014 == \"NaN\" ? \"-\" : htmlTables[0].drug == \"MDMA (Ecstasy)\" ? htmlTables[0]._2014 + \"†\" : htmlTables[0]._2014}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._2015 == \"NaN\" ? \"-\" : htmlTables[0]._2015}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._2016 == \"NaN\" ? \"-\" : htmlTables[0]._2016}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._2017 == \"NaN\" ? \"-\" : htmlTables[0]._2017}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._2018 == \"NaN\" ? \"-\" : htmlTables[0]._2018}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._2019 == \"NaN\" ? \"-\" : htmlTables[0]._2019}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._2020 == \"NaN\" ? \"-\" : htmlTables[0]._2020}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._2021 == \"NaN\" ? \"-\" : htmlTables[0]._2021}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[0]._2022 == \"NaN\" ? \"-\" : htmlTables[0]._2022}&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td class=\"sticky\" &gt;${htmlTables[1]?.time == undefined ? \"-\" : htmlTables[1]?.time}&lt;/td&gt;\n    &lt;td class=\"sticky\" &gt;${htmlTables[1]?.age == undefined ? \"-\" : htmlTables[1]?.age}&lt;/td&gt;\n    &lt;td&gt;-&lt;/td&gt;\n    &lt;td&gt;-&lt;/td&gt;\n    &lt;td&gt;-&lt;/td&gt;\n    &lt;td&gt;-&lt;/td&gt;\n    &lt;td&gt;-&lt;/td&gt;\n    &lt;td&gt;-&lt;/td&gt;\n    &lt;td&gt;-&lt;/td&gt;\n    &lt;td&gt;-&lt;/td&gt;\n    &lt;td&gt;-&lt;/td&gt;\n    &lt;td&gt;-&lt;/td&gt;\n    &lt;td&gt;-&lt;/td&gt;\n    &lt;td&gt;-&lt;/td&gt;\n    &lt;td&gt;-&lt;/td&gt;\n    &lt;td&gt;-&lt;/td&gt;\n    &lt;td&gt;-&lt;/td&gt;\n    &lt;td&gt;-&lt;/td&gt;\n    &lt;td&gt;-&lt;/td&gt;\n    &lt;td&gt;-&lt;/td&gt;\n    &lt;td&gt;-&lt;/td&gt;\n    &lt;td&gt;-&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2008 == \"NaN\" ? \"-\" : htmlTables[1]?._2008 == undefined ? \"-\" : htmlTables[1]?._2008}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2009 == \"NaN\" ? \"-\" : htmlTables[1]?._2009 == undefined ? \"-\" : htmlTables[1]?._2009}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2010 == \"NaN\" ? \"-\" : htmlTables[1]?._2010 == undefined ? \"-\" : htmlTables[1]?._2010}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2011 == \"NaN\" ? \"-\" : htmlTables[1]?._2011 == undefined ? \"-\" : htmlTables[1]?._2011}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2012 == \"NaN\" ? \"-\" : htmlTables[1]?._2012 == undefined ? \"-\" : htmlTables[1]?._2012}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2013 == \"NaN\" ? \"-\" : htmlTables[1]?._2013 == undefined ? \"-\" : htmlTables[1]?._2013}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2014 == \"NaN\" ? \"-\" : htmlTables[1]?._2014 == undefined ? \"-\" : htmlTables[1]?._2014}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2015 == \"NaN\" ? \"-\" : htmlTables[1]?._2015 == undefined ? \"-\" : htmlTables[1]?._2015}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2016 == \"NaN\" ? \"-\" : htmlTables[1]?._2016 == undefined ? \"-\" : htmlTables[1]?._2016}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2017 == \"NaN\" ? \"-\" : htmlTables[1]?._2017 == undefined ? \"-\" : htmlTables[1]?._2017}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2018 == \"NaN\" ? \"-\" : htmlTables[1]?._2018 == undefined ? \"-\" : htmlTables[1]?._2018}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2019 == \"NaN\" ? \"-\" : htmlTables[1]?._2019 == undefined ? \"-\" : htmlTables[1]?._2019}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2020 == \"NaN\" ? \"-\" : htmlTables[1]?._2020 == undefined ? \"-\" : htmlTables[1]?._2020}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2021 == \"NaN\" ? \"-\" : htmlTables[1]?._2021 == undefined ? \"-\" : htmlTables[1]?._2021}&lt;/td&gt;\n    &lt;td&gt;${htmlTables[1]?._2022 == \"NaN\" ? \"-\" : htmlTables[1]?._2022 == undefined ? \"-\" : htmlTables[1]?._2022}&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt;\n`"
  },
  {
    "objectID": "panel/substance-use/documentation.html#table-long-format",
    "href": "panel/substance-use/documentation.html#table-long-format",
    "title": "Documentation",
    "section": "Table Long Format",
    "text": "Table Long Format\n\nlongTable = Inputs.table(tablesTime, {\n  columns: [\n    \"year\",\n    \"age_18\",\n    \"age_19_20\",\n    \"age_21_22\",\n    \"age_23_24\",\n    \"age_25_26\",\n    \"age_27_28\",\n    \"age_29_30\",\n    \"age_35\",\n    \"age_40\",\n    \"age_45\",\n    \"age_50\",\n    \"age_55\",\n    \"age_60\",\n    \"age_65\"\n  ],\n  header: {\n    year: \"Year\",\n    age_18: \"Age 18\",\n    age_19_20: \"Ages 19-20\",\n    age_21_22: \"Ages 21-22\",\n    age_23_24: \"Ages 23-24\",\n    age_25_26: \"Ages 25-26\",\n    age_27_28: \"Ages 27-28\",\n    age_29_30: \"Ages 29-30\",\n    age_35: \"Age 35\",\n    age_40: \"Age 40\",\n    age_45: \"Age 45\",\n    age_50: \"Age 50\",\n    age_55: \"Age 55\",\n    age_60: \"Age 60\",\n    age_65: \"Age 65\"\n  },\n    format: {\n    year: d =&gt; html`&lt;b&gt;${d}&lt;/b&gt;`,\n    age_18: d=&gt; d.toFixed(1),\n    age_19_20: d=&gt; d.toFixed(1),\n    age_21_22: d=&gt; d.toFixed(1),\n    age_23_24: d=&gt; d.toFixed(1),\n    age_25_26: d=&gt; d.toFixed(1),\n    age_27_28: d=&gt; d.toFixed(1),\n    age_29_30: d=&gt; d.toFixed(1),\n    age_35: d=&gt; d.toFixed(1),\n    age_40: d=&gt; d.toFixed(1),\n    age_45: d=&gt; d.toFixed(1),\n    age_50: d=&gt; d.toFixed(1),\n    age_55: d=&gt; d.toFixed(1),\n    age_60: d=&gt; d.toFixed(1),\n    age_65: d=&gt; d.toFixed(1)\n  },\n  rows: 75,\n  width: 1200\n})"
  },
  {
    "objectID": "panel/substance-use/documentation.html#accordion-buttons",
    "href": "panel/substance-use/documentation.html#accordion-buttons",
    "title": "Documentation",
    "section": "Accordion Buttons",
    "text": "Accordion Buttons\n\naccordionButtons = \nhtml`\n&lt;div style=\"width: 90%\" class=\"accordion accordion-flush\" id=\"accordionFlushExample\"&gt;\n  &lt;div class=\"accordion-item\"&gt;\n    &lt;h2 class=\"accordion-header\" id=\"flush-headingOne\"&gt;\n      &lt;button class=\"accordion-button collapsed\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#flush-collapseOne\" aria-expanded=\"false\" aria-controls=\"flush-collapseOne\"&gt;\n        ${radio[0].drug}: Trends in ${radio[0].time} Prevalence Table\n      &lt;/button&gt;\n    &lt;/h2&gt;\n    &lt;div id=\"flush-collapseOne\" class=\"accordion-collapse collapse\" aria-labelledby=\"flush-headingOne\" data-bs-parent=\"#accordionFlushExample\"&gt;\n      &lt;div class=\"accordion-body\"&gt;\n              &lt;div class=\"center\"&gt;&lt;div&gt;${longTable}&lt;/div&gt;&lt;/div&gt;\n                &lt;div&gt;                      \n          &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;`"
  },
  {
    "objectID": "panel/substance-use/documentation.html#citation",
    "href": "panel/substance-use/documentation.html#citation",
    "title": "Documentation",
    "section": "Citation",
    "text": "Citation\n\ncitation = html`&lt;div style=\"max-width: 750px;\"&gt;&lt;p style=\"font-size: small;\"&gt;Suggested citation: Patrick, M. E., Miech, R. A., Johnston, L. D., & O’Malley, P. M. (2024). Monitoring the Future Panel Study annual report: National data on substance use among adults ages 19 to 65, 1976-2023. Monitoring the Future Monograph Series. Ann Arbor: Institute for Social Research, The University of Michigan.&lt;/p&gt;&lt;/div&gt;`"
  },
  {
    "objectID": "panel/substance-use/documentation.html#footnotes",
    "href": "panel/substance-use/documentation.html#footnotes",
    "title": "Documentation",
    "section": "Footnotes",
    "text": "Footnotes\n\nfootnotesData = FileAttachment(\"Footnotes.csv\").csv({ typed: true })\n\nfootnotesFiltered = footnotesData.filter(\n  ({ drug }) =&gt; drug.toLocaleLowerCase() === select.toLocaleLowerCase()\n)\n\n function checkFootnote(d) {\n  if (d.length == 0 ) {\n  return html`&lt;div&gt;&lt;/div&gt;`;\n} else if (d.length == 1) {\n  return html`&lt;div style=\"max-width: 750px;\"&gt;&lt;p style=\"font-size: small;\"&gt;&lt;sup&gt;${footnotesFiltered[0]?.superscript}&lt;/sup&gt;${footnotesFiltered[0]?.footnote}&lt;/p&gt;&lt;/div&gt;`;\n} else {\n  return html`&lt;div style=\"max-width: 750px;\"&gt;&lt;p style=\"font-size: small;\"&gt;&lt;sup&gt;${footnotesFiltered[0]?.superscript}&lt;/sup&gt;${footnotesFiltered[0]?.footnote}&lt;br&gt;&lt;sup&gt;${footnotesFiltered[1]?.superscript}&lt;/sup&gt;${footnotesFiltered[1]?.footnote}&lt;/p&gt;&lt;/div&gt;`;\n}\n}\n\nfootnotes = checkFootnote(footnotesFiltered)\n\nhtml`${footnotes}`"
  },
  {
    "objectID": "panel/substance-use/documentation.html#table-data",
    "href": "panel/substance-use/documentation.html#table-data",
    "title": "Documentation",
    "section": "Table Data",
    "text": "Table Data\n\ntables = FileAttachment(\"final_table_data.csv\").csv({ typed: true })\n\n\n\ntablesFormatted = {\n  const tables2 = tables.map(\n    ({ time, drug, year, age_18, age_19_20, age_21_22, age_23_24, age_25_26, age_27_28, age_29_30, age_35, age_40, age_45, age_50, age_55, age_60, age_65\n }) =&gt; ({\n      time: time,\n      drug: drug,\n      year: formatter(parser(year)),\n      age_18: +age_18,\n      age_19_20: +age_19_20, \n      age_21_22: +age_21_22, \n      age_23_24: +age_23_24, \n      age_25_26: +age_25_26, \n      age_27_28: +age_27_28, \n      age_29_30: +age_29_30, \n      age_35: +age_35, \n      age_40: +age_40, \n      age_45: +age_45, \n      age_50: +age_50, \n      age_55: +age_55, \n      age_60: +age_60, \n      age_65: +age_65\n    })\n  );\n\n  return tables2.filter(\n    ({ drug }) =&gt; drug?.toLocaleLowerCase() === select?.toLocaleLowerCase()\n  );\n}\n\n\ntablesTime = tablesFormatted.filter(({ time }) =&gt; time === radio[0].time)\n\ntablesTime"
  },
  {
    "objectID": "panel/substance-use/documentation.html#plot-data",
    "href": "panel/substance-use/documentation.html#plot-data",
    "title": "Documentation",
    "section": "Plot Data",
    "text": "Plot Data\n\nparser = d3.timeParse(\"%Y\")\n\nformat = d3.format(\".4\")\n\nraw = FileAttachment(\"final_graph2_data.csv\").csv({ typed: true })\nrawAlphabetical = raw.sort((a, b) =&gt; {\n  if (a.drug && b.drug) {\n    return a.drug.localeCompare(b.drug);\n  } else {\n    return 0; // Preserve the order if 'name' is missing\n  }\n});\n\nrawAlphabetical\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nprevalence = rawAlphabetical.filter(thing =&gt; thing.drug != null)\n\n\ndata = {\n  const subset = prevalence.map(\n    ({ year, drug, estimate, age, time, flag }) =&gt; ({\n      year: parser(year),\n      year2: format(year),\n      estimate: +estimate,\n      drug: drug,\n      age: age,\n      time: time,\n      flag: flag\n    })\n  );\n\n  const filtered = subset.filter(thing =&gt; \n  thing.drug?.toLocaleLowerCase() === select?.toLocaleLowerCase()\n);\n\n  return filtered;\n}\n\ndata\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nradio"
  },
  {
    "objectID": "panel/substance-use/documentation.html#search-bar",
    "href": "panel/substance-use/documentation.html#search-bar",
    "title": "Documentation",
    "section": "Search Bar",
    "text": "Search Bar\n\nimport {PersistInput} from \"@john-guerra/persist-input@latest\"\nimport {aq, op} from \"@uwdata/arquero\"\n\nviewof drugs = aq // viewof shows the table view, but assigns the table value\n  .fromCSV(await FileAttachment(\"substance-use-graphs.csv\").text())\n  .groupby(\"drug\")\n  .count()\n  .view({ height: 240 })\n\ndrugSelection = drugs.objects()\n\nviewof search = PersistInput(\n  \"drug\",\n  Inputs.text({\n    datalist: drugSelection.map((d) =&gt; d.drug),\n    placeholder: \"Enter drug name\",\n    submit: true,\n    label: \"Search Drug:\",\n    autocomplete: false,\n    spellcheck: true,\n    width: 350\n  })\n)"
  },
  {
    "objectID": "panel/substance-use/documentation.html#dropdown-input",
    "href": "panel/substance-use/documentation.html#dropdown-input",
    "title": "Documentation",
    "section": "Dropdown Input",
    "text": "Dropdown Input\n\nviewof select = PersistInput(\"drug\",\nInputs.select(\n  prevalence.map((d) =&gt; d.drug),\n  {\n    value: \"Alcohol\",\n    width: 175,\n    unique: true\n  }\n))"
  },
  {
    "objectID": "panel/substance-use/documentation.html#radio-buttons",
    "href": "panel/substance-use/documentation.html#radio-buttons",
    "title": "Documentation",
    "section": "Radio Buttons",
    "text": "Radio Buttons\n\nviewof radio = {\n  const values = d3.group(data, (d) =&gt; d.time);\n  return Inputs.radio(values, {\n    key: values.has(\"12 Month\")\n      ? \"12 Month\"\n      : values.keys().next().value\n  });\n}"
  },
  {
    "objectID": "panel/substance-use/documentation.html#zoom-in-button",
    "href": "panel/substance-use/documentation.html#zoom-in-button",
    "title": "Documentation",
    "section": "Zoom-in Button",
    "text": "Zoom-in Button\n\nfunction buttonToggle({ \n  onText = \"Zoom in\",\n  offText = \"Zoom out\",\n  value = 0,\n  click = (value, clicks) =&gt; clicks\n} = {}) {\n  let text = onText,\n    ml = html`&lt;button type=\"button\" class=\"btn btn-outline-primary\"&gt;${text}&lt;/button&gt;`,\n    clicks = 0,\n    v = value;\n\n  ml.value = v;\n  ml.onclick = () =&gt; {\n    v = click(v, ++clicks);\n\n    ml.value = v;\n    ml.innerHTML = clicks % 2 === 0 ? onText : offText;\n  };\n  return ml;\n}\n\nmax = Math.max(...legendData.map((o) =&gt; o.estimate))\nmin = Math.min(...legendData.map((o) =&gt; o.estimate))\nyAxis = max + (max-min)\n\nmax\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nmin\n\n\n\n\n\n\n\nyscale = {\n  if (zoomInButton % 2 == 0) {\n    return [0, 100]; // If this statement is true, return this\n  } else {\n    return [0, yAxis]; // If the second statement is true, return this\n  }\n}\n\nviewof zoomInButton = buttonToggle()\n\nlegendData\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction dataToggle({ \n  onText = \"Show All Age Groups\",\n  offText = \"Show Combined Age Groups\",\n  value = 0,\n  click = (value, clicks) =&gt; clicks\n} = {}) {\n  let text = onText,\n    ml = html`&lt;button type=\"button\" class=\"btn btn-outline-primary\"&gt;${text}&lt;/button&gt;`,\n    clicks = 0,\n    v = value;\n\n  ml.value = v;\n  ml.onclick = () =&gt; {\n    v = click(v, ++clicks);\n\n    ml.value = v;\n    ml.innerHTML = clicks % 2 === 0 ? onText : offText;\n  };\n  return ml;\n}\n\n\nplots = {\n  if (dataSwitchButton % 2 == 0) {\n    return comboPlot; // If this statement is true, return this\n  } else {\n    return plot2; // If the second statement is true, return this\n  }\n}\n\nhtml`&lt;div&gt;${plots}&lt;/di&gt;`\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nviewof dataSwitchButton = dataToggle()\n\n\n\n\n\n\n\n\nExplain this"
  },
  {
    "objectID": "panel/substance-use/documentation.html#download-data-button",
    "href": "panel/substance-use/documentation.html#download-data-button",
    "title": "Documentation",
    "section": "Download Data Button",
    "text": "Download Data Button\n\ndownloadButton = (data, filename) =&gt; {\n  \n  let downloadData;\n  downloadData = new Blob([d3.csvFormat(data)], { type: \"text/csv\" });\n  const size = (downloadData.size / 1024).toFixed(0);\n  const button = DOM.download(\n    downloadData,\n    filename,\n    `Download ${filename} Dataset (~${size} KB)`\n  );\n  return button;\n}\n\nname = `${radio[0].drug} - ${radio[0].time}`\n\ndata2 = radio.map(d =&gt; ({...d, year: d.year2}))\n\ndata3 = data2.map(({year2, ...keep}) =&gt; keep)\n\ndownloadData = downloadButton(data3, name)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ndownloadButton is a function that takes an array of data as the first argument and the name you want to call the file as the second argument. It displays the filename and the size of the file in kilobytes."
  },
  {
    "objectID": "panel/substance-use/documentation.html#plot-title",
    "href": "panel/substance-use/documentation.html#plot-title",
    "title": "Documentation",
    "section": "Plot Title",
    "text": "Plot Title\n\nageQuestion = significance.length &gt; 1\n  ? \"Respondents Aged 19 through 65\"\n  : \"Respondents Aged 19 through 30\""
  },
  {
    "objectID": "panel/substance-use/documentation.html#rendered-plot-for-combined-age-groups",
    "href": "panel/substance-use/documentation.html#rendered-plot-for-combined-age-groups",
    "title": "Documentation",
    "section": "Rendered Plot for Combined Age Groups",
    "text": "Rendered Plot for Combined Age Groups\n\nimport {addTooltips} from \"@mkfreeman/plot-tooltip\"\n\nformatter = d3.timeFormat(\"%Y\")\n\ncolor = d3.scaleOrdinal(\n  [\"Age 19-30\", \"Age 35-50\", \"Age 55-65\"],\n  [\"#59bbeb\", \"#6ac4a1\", \"#cca438\"]\n)\n\nsymbol = d3.scaleOrdinal(\n  [\"Age 19-30\", \"Age 35-50\", \"Age 55-65\"],\n  [\"circle\", \"square\", \"triangle\"]\n)\n\ndateFilter1 = radio.filter(d =&gt; d.year &gt; new Date(\"1988-01-01\"));\ndateFilter2 = radio.filter(d =&gt; d.year &gt; new Date(\"2008-01-01\"));\ndateFilter3 = radio.filter(d =&gt; d.year &gt; new Date(\"2023-01-01\"));\nlegendFilter1 = dateFilter1.filter(d =&gt; d.age === \"Age 19-30\");\nlegendFilter2 = dateFilter2.filter(d =&gt; d.age === \"Age 35-50\");\nlegendFilter3 = dateFilter3.filter(d =&gt; d.age === \"Age 55-65\");\n\nlegendData = [...legendFilter1, ...legendFilter2, ...legendFilter3];\nlegendData\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nplot = addTooltips(\n  Plot.plot({\n    ariaLabel: \"Adult and Young Adult Substance Use Line Charts\",\n    ariaDescription:\n      \"Drug Prevalence Chart showing estimates of use over time (1975 to 2022) in 19-30 and 35-50 year olds filtered by drug name and reporting interval. Currently showing ${radio[0].drug}\",\n    width: 900,\n    height: 700,\n    marginBottom: 50,\n    marginLeft: 50,\n    style: {\n      overflow: \"visible\",\n      fontSize: 12\n    },\n      symbol: {\n      domain: new Set(legendData.map((d) =&gt; d.age)),\n      range: [...new Set(legendData.map((d) =&gt; d.age))].map(symbol),\n      legend: true,\n      swatchSize: 23\n    },\n      color: {\n      domain: new Set(legendData.map((d) =&gt; d.age)),\n      range: [...new Set(legendData.map((d) =&gt; d.age))].map(color),\n    },\n    y: {\n      label: \"Percentage (%)\",\n      labelAnchor: \"center\",\n      domain: yscale\n    },\n    x: {\n      type: \"time\",\n      domain: [new Date(\"1987-01-01\"), new Date(\"2024-01-01\")],\n      label: \"Years\",\n      anchor: \"bottom\",\n      labelAnchor: \"center\"\n    },\n    marks: [\n      Plot.ruleY([0]),\n      Plot.dot(legendData, {\n        x: \"year\",\n        y: \"estimate\",\n        r: 4,\n        fill: \"age\",\n        symbol: \"age\",\n        title: (d) =&gt; `${d.age} \\n ${formatter(d.year)}: ${d.estimate}%`\n      }),\n      Plot.line(legendData, {\n        x: \"year\",\n        y: \"estimate\",\n        z: (d) =&gt; // This creates the line breaks\n          [\n            d.age,\n            d.flag\n          ].join(),\n        stroke: \"age\"})\n        ]\n  }),\n  { fill: \"age\" }\n)"
  },
  {
    "objectID": "panel/substance-use/documentation.html#all-ages-heatmap",
    "href": "panel/substance-use/documentation.html#all-ages-heatmap",
    "title": "Documentation",
    "section": "All Ages Heatmap",
    "text": "All Ages Heatmap\n\nfilter1 = radio.filter(d =&gt; d.age != \"Ages 19-30\")\nfilter2 = filter1.filter(d =&gt; d.age != \"Ages 35-50\")\n\nplot2 = addTooltips(Plot.plot({\n  marginTop: 50,\n  marginLeft: 100,  \n  width: 1500,\n  height: 500,\n  grid: true,\n  x: {axis: \"top\", label: \"Year\", type: \"band\"},\n  y: {label: \"Age\", domain: [\"Ages 19-20\", \"Ages 21-22\", \"Ages 23-24\", \"Ages 25-26\", \"Ages 27-28\", \"Ages 29-30\", \"Age 35\", \"Age 40\", \"Age 45\", \"Age 50\", \"Age 55\", \"Age 60\"]},\n  color: {type: \"linear\", scheme: \"BuRd\", legend: true, label: \"Drug Use Estimate\"},\n  marks: [\n    Plot.cell(filter2, {x: \"year2\", y: \"age\", fill: \"estimate\", inset: 0.5, title: (d) =&gt; `${d.age} \\n ${formatter(d.year)}: ${d.estimate}%`}),\n    Plot.text(filter2, {x: \"year2\", y: \"age\", text: \"estimate\", stroke: \"white\", strokeOpacity: 0.7, fill: \"black\", title: (d) =&gt; `${d.age} \\n ${formatter(d.year)}: ${d.estimate}%`})\n  ]\n}),\n{fill: \"estimate\"}\n)"
  },
  {
    "objectID": "panel/substance-use/documentation.html#combined-sig-plot-with-legend",
    "href": "panel/substance-use/documentation.html#combined-sig-plot-with-legend",
    "title": "Documentation",
    "section": "Combined Sig Plot with Legend",
    "text": "Combined Sig Plot with Legend\n\ncomboPlot = html`\n&lt;div style=\"position: relative;\"&gt;\n  ${plot}\n  &lt;div style=\"position: absolute; ${legendPlace} border: solid 1px black;\"&gt;\n    ${sigLegend}\n  &lt;/div&gt;\n&lt;/div&gt;`"
  }
]